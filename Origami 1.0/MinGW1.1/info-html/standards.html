<html lang="en"><head>
<title>GNU Coding Standards</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name=description content="GNU Coding Standards">
<meta name=generator content="makeinfo 4.0">
<link href="http://texinfo.org/" rel=generator-home>
</head><body>


<p>GNU Coding Standards
Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998 Free Software Foundation, Inc.

<p>Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

<p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the entire
resulting derived work is distributed under the terms of a permission
notice identical to this one.

<p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation approved
by the Free Software Foundation.

<p><hr>
Node:<a name="Top">Top</a>,
Next:<a rel=next href="#Preface">Preface</a>,
<br>

<h1>Version</h1>

<p>Last updated March 13, 1998.

<ul>
<li><a href="#Preface">Preface</a>:                      About the GNU Coding Standards
<li><a href="#Intellectual%20Property">Intellectual Property</a>:        Keeping Free Software Free
<li><a href="#Design%20Advice">Design Advice</a>:                General Program Design
<li><a href="#Program%20Behavior">Program Behavior</a>:             Program Behavior for All Programs
<li><a href="#Writing%20C">Writing C</a>:                    Making The Best Use of C
<li><a href="#Documentation">Documentation</a>:                Documenting Programs
<li><a href="#Managing%20Releases">Managing Releases</a>:            The Release Process
</ul>

<p><hr>
Node:<a name="Preface">Preface</a>,
Next:<a rel=next href="#Intellectual%20Property">Intellectual Property</a>,
Previous:<a rel=previous href="#Top">Top</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>About the GNU Coding Standards</h1>

<p>The GNU Coding Standards were written by Richard Stallman and other GNU
Project volunteers.  Their purpose is to make the GNU system clean,
consistent, and easy to install.  This document can also be read as a
guide to writing portable, robust and reliable programs.  It focuses on
programs written in C, but many of the rules and principles are useful
even if you write in another programming language.  The rules often
state reasons for writing in a certain way.

<p>Corrections or suggestions for this document should be sent to
<a href="mailto:gnu@gnu.org">gnu@gnu.org</a>.  If you make a suggestion, please include a
suggested new wording for it; our time is limited.  We prefer a context
diff to the <code>standards.texi</code> or <code>make-stds.texi</code> files, but if
you don't have those files, please mail your suggestion anyway.

<p>This release of the GNU Coding Standards was last updated
March 13, 1998.

<p><hr>
Node:<a name="Intellectual%20Property">Intellectual Property</a>,
Next:<a rel=next href="#Design%20Advice">Design Advice</a>,
Previous:<a rel=previous href="#Preface">Preface</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Keeping Free Software Free</h1>

<p>This node discusses how you can make sure that GNU software
remains unencumbered.

<ul>
<li><a href="#Reading%20Non-Free%20Code">Reading Non-Free Code</a>:        Referring to Proprietary Programs
<li><a href="#Contributions">Contributions</a>:                Accepting Contributions
</ul>

<p><hr>
Node:<a name="Reading%20Non-Free%20Code">Reading Non-Free Code</a>,
Next:<a rel=next href="#Contributions">Contributions</a>,
Up:<a rel=up href="#Intellectual%20Property">Intellectual Property</a>
<br>

<h2>Referring to Proprietary Programs</h2>

<p>Don't in any circumstances refer to Unix source code for or during
your work on GNU!  (Or to any other proprietary programs.)

<p>If you have a vague recollection of the internals of a Unix program,
this does not absolutely mean you can't write an imitation of it, but
do try to organize the imitation internally along different lines,
because this is likely to make the details of the Unix version
irrelevant and dissimilar to your results.

<p>For example, Unix utilities were generally optimized to minimize
memory use; if you go for speed instead, your program will be very
different.  You could keep the entire input file in core and scan it
there instead of using stdio.  Use a smarter algorithm discovered more
recently than the Unix program.  Eliminate use of temporary files.  Do
it in one pass instead of two (we did this in the assembler).

<p>Or, on the contrary, emphasize simplicity instead of speed.  For some
applications, the speed of today's computers makes simpler algorithms
adequate.

<p>Or go for generality.  For example, Unix programs often have static
tables or fixed-size strings, which make for arbitrary limits; use
dynamic allocation instead.  Make sure your program handles NULs and
other funny characters in the input files.  Add a programming language
for extensibility and write part of the program in that language.

<p>Or turn some parts of the program into independently usable libraries. 
Or use a simple garbage collector instead of tracking precisely when
to free memory, or use a new GNU facility such as obstacks.

<p><hr>
Node:<a name="Contributions">Contributions</a>,
Previous:<a rel=previous href="#Reading%20Non-Free%20Code">Reading Non-Free Code</a>,
Up:<a rel=up href="#Intellectual%20Property">Intellectual Property</a>
<br>

<h2>Accepting Contributions</h2>

<p>If someone else sends you a piece of code to add to the program you are
working on, we need legal papers to use it--the same sort of legal
papers we will need to get from you.  <em>Each</em> significant
contributor to a program must sign some sort of legal papers in order
for us to have clear title to the program.  The main author alone is not
enough.

<p>So, before adding in any contributions from other people, please tell
us, so we can arrange to get the papers.  Then wait until we tell you
that we have received the signed papers, before you actually use the
contribution.

<p>This applies both before you release the program and afterward.  If
you receive diffs to fix a bug, and they make significant changes, we
need legal papers for that change.

<p>This also applies to comments and documentation files.  For copyright
law, comments and code are just text.  Copyright applies to all kinds of
text, so we need legal papers for all kinds.

<p>You don't need papers for changes of a few lines here or there, since
they are not significant for copyright purposes.  Also, you don't need
papers if all you get from the suggestion is some ideas, not actual code
which you use.  For example, if you write a different solution to the
problem, you don't need to get papers.

<p>We know this is frustrating; it's frustrating for us as well.  But if
you don't wait, you are going out on a limb--for example, what if the
contributor's employer won't sign a disclaimer?  You might have to take
that code out again!

<p>The very worst thing is if you forget to tell us about the other
contributor.  We could be very embarrassed in court some day as a
result.

<p>We have more detailed advice for maintainers of programs; if you have
reached the stage of actually maintaining a program for GNU (whether
released or not), please ask us for a copy.

<p><hr>
Node:<a name="Design%20Advice">Design Advice</a>,
Next:<a rel=next href="#Program%20Behavior">Program Behavior</a>,
Previous:<a rel=previous href="#Intellectual%20Property">Intellectual Property</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>General Program Design</h1>

<p>This node discusses some of the issues you should take into
account when designing your program.

<ul>
<li><a href="#Compatibility">Compatibility</a>:                Compatibility with other implementations
<li><a href="#Using%20Extensions">Using Extensions</a>:             Using non-standard features
<li><a href="#ANSI%20C">ANSI C</a>:                       Using ANSI C features
<li><a href="#Source%20Language">Source Language</a>:              Using languages other than C
</ul>

<p><hr>
Node:<a name="Compatibility">Compatibility</a>,
Next:<a rel=next href="#Using%20Extensions">Using Extensions</a>,
Up:<a rel=up href="#Design%20Advice">Design Advice</a>
<br>

<h2>Compatibility with Other Implementations</h2>

<p>With occasional exceptions, utility programs and libraries for GNU
should be upward compatible with those in Berkeley Unix, and upward
compatible with <small>ANSI</small> C if <small>ANSI</small> C specifies their behavior, and
upward compatible with <small>POSIX</small> if <small>POSIX</small> specifies their
behavior.

<p>When these standards conflict, it is useful to offer compatibility
modes for each of them.

<p><small>ANSI</small> C and <small>POSIX</small> prohibit many kinds of extensions.  Feel free
to make the extensions anyway, and include a <code>--ansi</code>,
<code>--posix</code>, or <code>--compatible</code> option to turn them off. 
However, if the extension has a significant chance of breaking any real
programs or scripts, then it is not really upward compatible.  Try to
redesign its interface.

<p>Many GNU programs suppress extensions that conflict with POSIX if the
environment variable <code>POSIXLY_CORRECT</code> is defined (even if it is
defined with a null value).  Please make your program recognize this
variable if appropriate.

<p>When a feature is used only by users (not by programs or command
files), and it is done poorly in Unix, feel free to replace it
completely with something totally different and better.  (For example,
<code>vi</code> is replaced with Emacs.)  But it is nice to offer a compatible
feature as well.  (There is a free <code>vi</code> clone, so we offer it.)

<p>Additional useful features not in Berkeley Unix are welcome.

<p><hr>
Node:<a name="Using%20Extensions">Using Extensions</a>,
Next:<a rel=next href="#ANSI%20C">ANSI C</a>,
Previous:<a rel=previous href="#Compatibility">Compatibility</a>,
Up:<a rel=up href="#Design%20Advice">Design Advice</a>
<br>

<h2>Using Non-standard Features</h2>

<p>Many GNU facilities that already exist support a number of convenient
extensions over the comparable Unix facilities.  Whether to use these
extensions in implementing your program is a difficult question.

<p>On the one hand, using the extensions can make a cleaner program. 
On the other hand, people will not be able to build the program
unless the other GNU tools are available.  This might cause the
program to work on fewer kinds of machines.

<p>With some extensions, it might be easy to provide both alternatives. 
For example, you can define functions with a "keyword" <code>INLINE</code>
and define that as a macro to expand into either <code>inline</code> or
nothing, depending on the compiler.

<p>In general, perhaps it is best not to use the extensions if you can
straightforwardly do without them, but to use the extensions if they
are a big improvement.

<p>An exception to this rule are the large, established programs (such as
Emacs) which run on a great variety of systems.  Such programs would
be broken by use of GNU extensions.

<p>Another exception is for programs that are used as part of
compilation: anything that must be compiled with other compilers in
order to bootstrap the GNU compilation facilities.  If these require
the GNU compiler, then no one can compile them without having them
installed already.  That would be no good.

<p><hr>
Node:<a name="ANSI%20C">ANSI C</a>,
Next:<a rel=next href="#Source%20Language">Source Language</a>,
Previous:<a rel=previous href="#Using%20Extensions">Using Extensions</a>,
Up:<a rel=up href="#Design%20Advice">Design Advice</a>
<br>

<h2><small>ANSI</small> C and pre-<small>ANSI</small> C</h2>

<p>Do not ever use the "trigraph" feature of <small>ANSI</small> C.

<p><small>ANSI</small> C is widespread enough now that it is ok to write new programs
that use <small>ANSI</small> C features (and therefore will not work in
non-<small>ANSI</small> compilers).  And if a program is already written in
<small>ANSI</small> C, there's no need to convert it to support non-<small>ANSI</small>
compilers.

<p>However, it is easy to support non-<small>ANSI</small> compilers in most programs,
so you might still consider doing so when you write a program.  Instead
of writing function definitions in <small>ANSI</small> prototype form,

<pre>int
foo (int x, int y)
<small>...</small>
</pre>

<p>write the definition in pre-<small>ANSI</small> style like this,

<pre>int
foo (x, y)
     int x, y;
<small>...</small>
</pre>

<p>and use a separate declaration to specify the argument prototype:

<pre>int foo (int, int);
</pre>

<p>You need such a declaration anyway, in a header file, to get the benefit
of <small>ANSI</small> C prototypes in all the files where the function is called. 
And once you have it, you lose nothing by writing the function
definition in the pre-<small>ANSI</small> style.

<p>If you don't know non-<small>ANSI</small> C, there's no need to learn it; just
write in <small>ANSI</small> C.

<p><hr>
Node:<a name="Source%20Language">Source Language</a>,
Previous:<a rel=previous href="#ANSI%20C">ANSI C</a>,
Up:<a rel=up href="#Design%20Advice">Design Advice</a>
<br>

<h2>Using Languages Other Than C</h2>

<p>Using a language other than C is like using a non-standard feature: it
will cause trouble for users.  Even if GCC supports the other language,
users may find it inconvenient to have to install the compiler for that
other language in order to build your program.  For example, if you
write your program in C++, people will have to install the C++ compiler
in order to compile your program.  Thus, it is better if you write in C.

<p>But there are three situations when there is no disadvantage in using
some other language:

<ul>
<li>It is okay to use another language if your program contains an
interpreter for that language.

<p>For example, if your program links with GUILE, it is ok to write part of
the program in Scheme or another language supported by GUILE.

</p><li>It is okay to use another language in a tool specifically intended for
use with that language.

<p>This is okay because the only people who want to build the tool will be
those who have installed the other language anyway.

</p><li>If an application is of interest to a narrow community, then perhaps
it's not important if the application is inconvenient to install. 
</ul>

<p>C has one other advantage over C++ and other compiled languages: more
people know C, so more people will find it easy to read and modify the
program if it is written in C.

<p><hr>
Node:<a name="Program%20Behavior">Program Behavior</a>,
Next:<a rel=next href="#Writing%20C">Writing C</a>,
Previous:<a rel=previous href="#Design%20Advice">Design Advice</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Program Behavior for All Programs</h1>

<p>This node describes how to write robust software. It also
describes general standards for error messages, the command line interface,
and how libraries should behave.

<ul>
<li><a href="#Semantics">Semantics</a>:                    Writing robust programs
<li><a href="#Libraries">Libraries</a>:                    Library behavior
<li><a href="#Errors">Errors</a>:                       Formatting error messages
<li><a href="#User%20Interfaces">User Interfaces</a>:              Standards for command line interfaces
<li><a href="#Option%20Table">Option Table</a>:                 Table of long options. 
<li><a href="#Memory%20Usage">Memory Usage</a>:                 When and how to care about memory needs
</ul>

<p><hr>
Node:<a name="Semantics">Semantics</a>,
Next:<a rel=next href="#Libraries">Libraries</a>,
Up:<a rel=up href="#Program%20Behavior">Program Behavior</a>
<br>

<h2>Writing Robust Programs</h2>

<p>Avoid arbitrary limits on the length or number of <em>any</em> data
structure, including file names, lines, files, and symbols, by allocating
all data structures dynamically.  In most Unix utilities, "long lines
are silently truncated".  This is not acceptable in a GNU utility.

<p>Utilities reading files should not drop NUL characters, or any other
nonprinting characters <em>including those with codes above 0177</em>.  The
only sensible exceptions would be utilities specifically intended for
interface to certain types of printers that can't handle those characters.

<p>Check every system call for an error return, unless you know you wish to
ignore errors.  Include the system error text (from <code>perror</code> or
equivalent) in <em>every</em> error message resulting from a failing
system call, as well as the name of the file if any and the name of the
utility.  Just "cannot open foo.c" or "stat failed" is not
sufficient.

<p>Check every call to <code>malloc</code> or <code>realloc</code> to see if it
returned zero.  Check <code>realloc</code> even if you are making the block
smaller; in a system that rounds block sizes to a power of 2,
<code>realloc</code> may get a different block if you ask for less space.

<p>In Unix, <code>realloc</code> can destroy the storage block if it returns
zero.  GNU <code>realloc</code> does not have this bug: if it fails, the
original block is unchanged.  Feel free to assume the bug is fixed.  If
you wish to run your program on Unix, and wish to avoid lossage in this
case, you can use the GNU <code>malloc</code>.

<p>You must expect <code>free</code> to alter the contents of the block that was
freed.  Anything you want to fetch from the block, you must fetch before
calling <code>free</code>.

<p>If <code>malloc</code> fails in a noninteractive program, make that a fatal
error.  In an interactive program (one that reads commands from the
user), it is better to abort the command and return to the command
reader loop.  This allows the user to kill other processes to free up
virtual memory, and then try the command again.

<p>Use <code>getopt_long</code> to decode arguments, unless the argument syntax
makes this unreasonable.

<p>When static storage is to be written in during program execution, use
explicit C code to initialize it.  Reserve C initialized declarations
for data that will not be changed.

<p>Try to avoid low-level interfaces to obscure Unix data structures (such
as file directories, utmp, or the layout of kernel memory), since these
are less likely to work compatibly.  If you need to find all the files
in a directory, use <code>readdir</code> or some other high-level interface. 
These will be supported compatibly by GNU.

<p>By default, the GNU system will provide the signal handling functions of
<small>BSD</small> and of <small>POSIX</small>.  So GNU software should be written to use
these.

<p>In error checks that detect "impossible" conditions, just abort. 
There is usually no point in printing any message.  These checks
indicate the existence of bugs.  Whoever wants to fix the bugs will have
to read the source code and run a debugger.  So explain the problem with
comments in the source.  The relevant data will be in variables, which
are easy to examine with the debugger, so there is no point moving them
elsewhere.

<p>Do not use a count of errors as the exit status for a program. 
<em>That does not work</em>, because exit status values are limited to 8
bits (0 through 255).  A single run of the program might have 256
errors; if you try to return 256 as the exit status, the parent process
will see 0 as the status, and it will appear that the program succeeded.

<p>If you make temporary files, check the <code>TMPDIR</code> environment
variable; if that variable is defined, use the specified directory
instead of <code>/tmp</code>.

<p><hr>
Node:<a name="Libraries">Libraries</a>,
Next:<a rel=next href="#Errors">Errors</a>,
Previous:<a rel=previous href="#Semantics">Semantics</a>,
Up:<a rel=up href="#Program%20Behavior">Program Behavior</a>
<br>

<h2>Library Behavior</h2>

<p>Try to make library functions reentrant.  If they need to do dynamic
storage allocation, at least try to avoid any nonreentrancy aside from
that of <code>malloc</code> itself.

<p>Here are certain name conventions for libraries, to avoid name
conflicts.

<p>Choose a name prefix for the library, more than two characters long. 
All external function and variable names should start with this
prefix.  In addition, there should only be one of these in any given
library member.  This usually means putting each one in a separate
source file.

<p>An exception can be made when two external symbols are always used
together, so that no reasonable program could use one without the
other; then they can both go in the same file.

<p>External symbols that are not documented entry points for the user
should have names beginning with <code>_</code>.  They should also contain
the chosen name prefix for the library, to prevent collisions with
other libraries.  These can go in the same files with user entry
points if you like.

<p>Static functions and variables can be used as you like and need not
fit any naming convention.

<p><hr>
Node:<a name="Errors">Errors</a>,
Next:<a rel=next href="#User%20Interfaces">User Interfaces</a>,
Previous:<a rel=previous href="#Libraries">Libraries</a>,
Up:<a rel=up href="#Program%20Behavior">Program Behavior</a>
<br>

<h2>Formatting Error Messages</h2>

<p>Error messages from compilers should look like this:

<pre><var>source-file-name</var>:<var>lineno</var>: <var>message</var>
</pre>

<p>Error messages from other noninteractive programs should look like this:

<pre><var>program</var>:<var>source-file-name</var>:<var>lineno</var>: <var>message</var>
</pre>

<p>when there is an appropriate source file, or like this:

<pre><var>program</var>: <var>message</var>
</pre>

<p>when there is no relevant source file.

<p>In an interactive program (one that is reading commands from a
terminal), it is better not to include the program name in an error
message.  The place to indicate which program is running is in the
prompt or with the screen layout.  (When the same program runs with
input from a source other than a terminal, it is not interactive and
would do best to print error messages using the noninteractive style.)

<p>The string <var>message</var> should not begin with a capital letter when
it follows a program name and/or file name.  Also, it should not end
with a period.

<p>Error messages from interactive programs, and other messages such as
usage messages, should start with a capital letter.  But they should not
end with a period.

<p><hr>
Node:<a name="User%20Interfaces">User Interfaces</a>,
Next:<a rel=next href="#Option%20Table">Option Table</a>,
Previous:<a rel=previous href="#Errors">Errors</a>,
Up:<a rel=up href="#Program%20Behavior">Program Behavior</a>
<br>

<h2>Standards for Command Line Interfaces</h2>

<p>Please don't make the behavior of a utility depend on the name used
to invoke it.  It is useful sometimes to make a link to a utility
with a different name, and that should not change what it does.

<p>Instead, use a run time option or a compilation switch or both
to select among the alternate behaviors.

<p>Likewise, please don't make the behavior of the program depend on the
type of output device it is used with.  Device independence is an
important principle of the system's design; do not compromise it
merely to save someone from typing an option now and then.

<p>If you think one behavior is most useful when the output is to a
terminal, and another is most useful when the output is a file or a
pipe, then it is usually best to make the default behavior the one that
is useful with output to a terminal, and have an option for the other
behavior.

<p>Compatibility requires certain programs to depend on the type of output
device.  It would be disastrous if <code>ls</code> or <code>sh</code> did not do so
in the way all users expect.  In some of these cases, we supplement the
program with a preferred alternate version that does not depend on the
output device type.  For example, we provide a <code>dir</code> program much
like <code>ls</code> except that its default output format is always
multi-column format.

<p>It is a good idea to follow the <small>POSIX</small> guidelines for the
command-line options of a program.  The easiest way to do this is to use
<code>getopt</code> to parse them.  Note that the GNU version of <code>getopt</code>
will normally permit options anywhere among the arguments unless the
special argument <code>--</code> is used.  This is not what <small>POSIX</small>
specifies; it is a GNU extension.

<p>Please define long-named options that are equivalent to the
single-letter Unix-style options.  We hope to make GNU more user
friendly this way.  This is easy to do with the GNU function
<code>getopt_long</code>.

<p>One of the advantages of long-named options is that they can be
consistent from program to program.  For example, users should be able
to expect the "verbose" option of any GNU program which has one, to be
spelled precisely <code>--verbose</code>.  To achieve this uniformity, look at
the table of common long-option names when you choose the option names
for your program (see <a href="#Option%20Table">Option Table</a>).

<p>It is usually a good idea for file names given as ordinary arguments to
be input files only; any output files would be specified using options
(preferably <code>-o</code> or <code>--output</code>).  Even if you allow an output
file name as an ordinary argument for compatibility, try to provide an
option as another way to specify it.  This will lead to more consistency
among GNU utilities, and fewer idiosyncracies for users to remember.

<p>All programs should support two standard options: <code>--version</code>
and <code>--help</code>.

<dl>
<dt><code>--version</code>
<dd>This option should direct the program to information about its name,
version, origin and legal status, all on standard output, and then exit
successfully.  Other options and arguments should be ignored once this
is seen, and the program should not perform its normal function.

<p>The first line is meant to be easy for a program to parse; the version
number proper starts after the last space.  In addition, it contains
the canonical name for this program, in this format:

<pre>GNU Emacs 19.30
</pre>

<p>The program's name should be a constant string; <em>don't</em> compute it
from <code>argv[0]</code>.  The idea is to state the standard or canonical
name for the program, not its file name.  There are other ways to find
out the precise file name where a command is found in <code>PATH</code>.

<p>If the program is a subsidiary part of a larger package, mention the
package name in parentheses, like this:

<pre>emacsserver (GNU Emacs) 19.30
</pre>

<p>If the package has a version number which is different from this
program's version number, you can mention the package version number
just before the close-parenthesis.

<p>If you <strong>need</strong> to mention the version numbers of libraries which
are distributed separately from the package which contains this program,
you can do so by printing an additional line of version info for each
library you want to mention.  Use the same format for these lines as for
the first line.

<p>Please do not mention all of the libraries that the program uses "just
for completeness"--that would produce a lot of unhelpful clutter. 
Please mention library version numbers only if you find in practice that
they are very important to you in debugging.

<p>The following line, after the version number line or lines, should be a
copyright notice.  If more than one copyright notice is called for, put
each on a separate line.

<p>Next should follow a brief statement that the program is free software,
and that users are free to copy and change it on certain conditions.  If
the program is covered by the GNU GPL, say so here.  Also mention that
there is no warranty, to the extent permitted by law.

<p>It is ok to finish the output with a list of the major authors of the
program, as a way of giving credit.

<p>Here's an example of output that follows these rules:

<pre>GNU Emacs 19.34.5
Copyright (C) 1996 Free Software Foundation, Inc.
GNU Emacs comes with NO WARRANTY,
to the extent permitted by law.
You may redistribute copies of GNU Emacs
under the terms of the GNU General Public License.
For more information about these matters,
see the files named COPYING.
</pre>

<p>You should adapt this to your program, of course, filling in the proper
year, copyright holder, name of program, and the references to
distribution terms, and changing the rest of the wording as necessary.

<p>This copyright notice only needs to mention the most recent year in
which changes were made--there's no need to list the years for previous
versions' changes.  You don't have to mention the name of the program in
these notices, if that is inconvenient, since it appeared in the first
line.

<br><dt><code>--help</code>
<dd>This option should output brief documentation for how to invoke the
program, on standard output, then exit successfully.  Other options and
arguments should be ignored once this is seen, and the program should
not perform its normal function.

<p>Near the end of the <code>--help</code> option's output there should be a line
that says where to mail bug reports.  It should have this format:

<pre>Report bugs to <var>mailing-address</var>.
</pre>
</dl>

<p><hr>
Node:<a name="Option%20Table">Option Table</a>,
Next:<a rel=next href="#Memory%20Usage">Memory Usage</a>,
Previous:<a rel=previous href="#User%20Interfaces">User Interfaces</a>,
Up:<a rel=up href="#Program%20Behavior">Program Behavior</a>
<br>

<h2>Table of Long Options</h2>

<p>Here is a table of long options used by GNU programs.  It is surely
incomplete, but we aim to list all the options that a new program might
want to be compatible with.  If you use names not already in the table,
please send <a href="mailto:gnu@gnu.org">gnu@gnu.org</a> a list of them, with their
meanings, so we can update the table.

<dl>
<dt><code>after-date</code>
<dd><code>-N</code> in <code>tar</code>.

<br><dt><code>all</code>
<dd><code>-a</code> in <code>du</code>, <code>ls</code>, <code>nm</code>, <code>stty</code>, <code>uname</code>,
and <code>unexpand</code>.

<br><dt><code>all-text</code>
<dd><code>-a</code> in <code>diff</code>.

<br><dt><code>almost-all</code>
<dd><code>-A</code> in <code>ls</code>.

<br><dt><code>append</code>
<dd><code>-a</code> in <code>etags</code>, <code>tee</code>, <code>time</code>;
<code>-r</code> in <code>tar</code>.

<br><dt><code>archive</code>
<dd><code>-a</code> in <code>cp</code>.

<br><dt><code>archive-name</code>
<dd><code>-n</code> in <code>shar</code>.

<br><dt><code>arglength</code>
<dd><code>-l</code> in <code>m4</code>.

<br><dt><code>ascii</code>
<dd><code>-a</code> in <code>diff</code>.

<br><dt><code>assign</code>
<dd><code>-v</code> in <code>gawk</code>.

<br><dt><code>assume-new</code>
<dd><code>-W</code> in Make.

<br><dt><code>assume-old</code>
<dd><code>-o</code> in Make.

<br><dt><code>auto-check</code>
<dd><code>-a</code> in <code>recode</code>.

<br><dt><code>auto-pager</code>
<dd><code>-a</code> in <code>wdiff</code>.

<br><dt><code>auto-reference</code>
<dd><code>-A</code> in <code>ptx</code>.

<br><dt><code>avoid-wraps</code>
<dd><code>-n</code> in <code>wdiff</code>.

<br><dt><code>backward-search</code>
<dd><code>-B</code> in <code>ctags</code>.

<br><dt><code>basename</code>
<dd><code>-f</code> in <code>shar</code>.

<br><dt><code>batch</code>
<dd>Used in GDB.

<br><dt><code>baud</code>
<dd>Used in GDB.

<br><dt><code>before</code>
<dd><code>-b</code> in <code>tac</code>.

<br><dt><code>binary</code>
<dd><code>-b</code> in <code>cpio</code> and <code>diff</code>.

<br><dt><code>bits-per-code</code>
<dd><code>-b</code> in <code>shar</code>.

<br><dt><code>block-size</code>
<dd>Used in <code>cpio</code> and <code>tar</code>.

<br><dt><code>blocks</code>
<dd><code>-b</code> in <code>head</code> and <code>tail</code>.

<br><dt><code>break-file</code>
<dd><code>-b</code> in <code>ptx</code>.

<br><dt><code>brief</code>
<dd>Used in various programs to make output shorter.

<br><dt><code>bytes</code>
<dd><code>-c</code> in <code>head</code>, <code>split</code>, and <code>tail</code>.

<br><dt><code>c<tt>++</tt></code>
<dd><code>-C</code> in <code>etags</code>.

<br><dt><code>catenate</code>
<dd><code>-A</code> in <code>tar</code>.

<br><dt><code>cd</code>
<dd>Used in various programs to specify the directory to use.

<br><dt><code>changes</code>
<dd><code>-c</code> in <code>chgrp</code> and <code>chown</code>.

<br><dt><code>classify</code>
<dd><code>-F</code> in <code>ls</code>.

<br><dt><code>colons</code>
<dd><code>-c</code> in <code>recode</code>.

<br><dt><code>command</code>
<dd><code>-c</code> in <code>su</code>;
<code>-x</code> in GDB.

<br><dt><code>compare</code>
<dd><code>-d</code> in <code>tar</code>.

<br><dt><code>compat</code>
<dd>Used in <code>gawk</code>.

<br><dt><code>compress</code>
<dd><code>-Z</code> in <code>tar</code> and <code>shar</code>.

<br><dt><code>concatenate</code>
<dd><code>-A</code> in <code>tar</code>.

<br><dt><code>confirmation</code>
<dd><code>-w</code> in <code>tar</code>.

<br><dt><code>context</code>
<dd>Used in <code>diff</code>.

<br><dt><code>copyleft</code>
<dd><code>-W copyleft</code> in <code>gawk</code>.

<br><dt><code>copyright</code>
<dd><code>-C</code> in <code>ptx</code>, <code>recode</code>, and <code>wdiff</code>;
<code>-W copyright</code> in <code>gawk</code>.

<br><dt><code>core</code>
<dd>Used in GDB.

<br><dt><code>count</code>
<dd><code>-q</code> in <code>who</code>.

<br><dt><code>count-links</code>
<dd><code>-l</code> in <code>du</code>.

<br><dt><code>create</code>
<dd>Used in <code>tar</code> and <code>cpio</code>.

<br><dt><code>cut-mark</code>
<dd><code>-c</code> in <code>shar</code>.

<br><dt><code>cxref</code>
<dd><code>-x</code> in <code>ctags</code>.

<br><dt><code>date</code>
<dd><code>-d</code> in <code>touch</code>.

<br><dt><code>debug</code>
<dd><code>-d</code> in Make and <code>m4</code>;
<code>-t</code> in Bison.

<br><dt><code>define</code>
<dd><code>-D</code> in <code>m4</code>.

<br><dt><code>defines</code>
<dd><code>-d</code> in Bison and <code>ctags</code>.

<br><dt><code>delete</code>
<dd><code>-D</code> in <code>tar</code>.

<br><dt><code>dereference</code>
<dd><code>-L</code> in <code>chgrp</code>, <code>chown</code>, <code>cpio</code>, <code>du</code>,
<code>ls</code>, and <code>tar</code>.

<br><dt><code>dereference-args</code>
<dd><code>-D</code> in <code>du</code>.

<br><dt><code>diacritics</code>
<dd><code>-d</code> in <code>recode</code>.

<br><dt><code>dictionary-order</code>
<dd><code>-d</code> in <code>look</code>.

<br><dt><code>diff</code>
<dd><code>-d</code> in <code>tar</code>.

<br><dt><code>digits</code>
<dd><code>-n</code> in <code>csplit</code>.

<br><dt><code>directory</code>
<dd>Specify the directory to use, in various programs.  In <code>ls</code>, it
means to show directories themselves rather than their contents.  In
<code>rm</code> and <code>ln</code>, it means to not treat links to directories
specially.

<br><dt><code>discard-all</code>
<dd><code>-x</code> in <code>strip</code>.

<br><dt><code>discard-locals</code>
<dd><code>-X</code> in <code>strip</code>.

<br><dt><code>dry-run</code>
<dd><code>-n</code> in Make.

<br><dt><code>ed</code>
<dd><code>-e</code> in <code>diff</code>.

<br><dt><code>elide-empty-files</code>
<dd><code>-z</code> in <code>csplit</code>.

<br><dt><code>end-delete</code>
<dd><code>-x</code> in <code>wdiff</code>.

<br><dt><code>end-insert</code>
<dd><code>-z</code> in <code>wdiff</code>.

<br><dt><code>entire-new-file</code>
<dd><code>-N</code> in <code>diff</code>.

<br><dt><code>environment-overrides</code>
<dd><code>-e</code> in Make.

<br><dt><code>eof</code>
<dd><code>-e</code> in <code>xargs</code>.

<br><dt><code>epoch</code>
<dd>Used in GDB.

<br><dt><code>error-limit</code>
<dd>Used in <code>makeinfo</code>.

<br><dt><code>error-output</code>
<dd><code>-o</code> in <code>m4</code>.

<br><dt><code>escape</code>
<dd><code>-b</code> in <code>ls</code>.

<br><dt><code>exclude-from</code>
<dd><code>-X</code> in <code>tar</code>.

<br><dt><code>exec</code>
<dd>Used in GDB.

<br><dt><code>exit</code>
<dd><code>-x</code> in <code>xargs</code>.

<br><dt><code>exit-0</code>
<dd><code>-e</code> in <code>unshar</code>.

<br><dt><code>expand-tabs</code>
<dd><code>-t</code> in <code>diff</code>.

<br><dt><code>expression</code>
<dd><code>-e</code> in <code>sed</code>.

<br><dt><code>extern-only</code>
<dd><code>-g</code> in <code>nm</code>.

<br><dt><code>extract</code>
<dd><code>-i</code> in <code>cpio</code>;
<code>-x</code> in <code>tar</code>.

<br><dt><code>faces</code>
<dd><code>-f</code> in <code>finger</code>.

<br><dt><code>fast</code>
<dd><code>-f</code> in <code>su</code>.

<br><dt><code>fatal-warnings</code>
<dd><code>-E</code> in <code>m4</code>.

<br><dt><code>file</code>
<dd><code>-f</code> in <code>info</code>, <code>gawk</code>, Make, <code>mt</code>, and <code>tar</code>;
<code>-n</code> in <code>sed</code>;
<code>-r</code> in <code>touch</code>.

<br><dt><code>field-separator</code>
<dd><code>-F</code> in <code>gawk</code>.

<br><dt><code>file-prefix</code>
<dd><code>-b</code> in Bison.

<br><dt><code>file-type</code>
<dd><code>-F</code> in <code>ls</code>.

<br><dt><code>files-from</code>
<dd><code>-T</code> in <code>tar</code>.

<br><dt><code>fill-column</code>
<dd>Used in <code>makeinfo</code>.

<br><dt><code>flag-truncation</code>
<dd><code>-F</code> in <code>ptx</code>.

<br><dt><code>fixed-output-files</code>
<dd><code>-y</code> in Bison.

<br><dt><code>follow</code>
<dd><code>-f</code> in <code>tail</code>.

<br><dt><code>footnote-style</code>
<dd>Used in <code>makeinfo</code>.

<br><dt><code>force</code>
<dd><code>-f</code> in <code>cp</code>, <code>ln</code>, <code>mv</code>, and <code>rm</code>.

<br><dt><code>force-prefix</code>
<dd><code>-F</code> in <code>shar</code>.

<br><dt><code>format</code>
<dd>Used in <code>ls</code>, <code>time</code>, and <code>ptx</code>.

<br><dt><code>freeze-state</code>
<dd><code>-F</code> in <code>m4</code>.

<br><dt><code>fullname</code>
<dd>Used in GDB.

<br><dt><code>gap-size</code>
<dd><code>-g</code> in <code>ptx</code>.

<br><dt><code>get</code>
<dd><code>-x</code> in <code>tar</code>.

<br><dt><code>graphic</code>
<dd><code>-i</code> in <code>ul</code>.

<br><dt><code>graphics</code>
<dd><code>-g</code> in <code>recode</code>.

<br><dt><code>group</code>
<dd><code>-g</code> in <code>install</code>.

<br><dt><code>gzip</code>
<dd><code>-z</code> in <code>tar</code> and <code>shar</code>.

<br><dt><code>hashsize</code>
<dd><code>-H</code> in <code>m4</code>.

<br><dt><code>header</code>
<dd><code>-h</code> in <code>objdump</code> and <code>recode</code>

<br><dt><code>heading</code>
<dd><code>-H</code> in <code>who</code>.

<br><dt><code>help</code>
<dd>Used to ask for brief usage information.

<br><dt><code>here-delimiter</code>
<dd><code>-d</code> in <code>shar</code>.

<br><dt><code>hide-control-chars</code>
<dd><code>-q</code> in <code>ls</code>.

<br><dt><code>idle</code>
<dd><code>-u</code> in <code>who</code>.

<br><dt><code>ifdef</code>
<dd><code>-D</code> in <code>diff</code>.

<br><dt><code>ignore</code>
<dd><code>-I</code> in <code>ls</code>;
<code>-x</code> in <code>recode</code>.

<br><dt><code>ignore-all-space</code>
<dd><code>-w</code> in <code>diff</code>.

<br><dt><code>ignore-backups</code>
<dd><code>-B</code> in <code>ls</code>.

<br><dt><code>ignore-blank-lines</code>
<dd><code>-B</code> in <code>diff</code>.

<br><dt><code>ignore-case</code>
<dd><code>-f</code> in <code>look</code> and <code>ptx</code>;
<code>-i</code> in <code>diff</code> and <code>wdiff</code>.

<br><dt><code>ignore-errors</code>
<dd><code>-i</code> in Make.

<br><dt><code>ignore-file</code>
<dd><code>-i</code> in <code>ptx</code>.

<br><dt><code>ignore-indentation</code>
<dd><code>-I</code> in <code>etags</code>.

<br><dt><code>ignore-init-file</code>
<dd><code>-f</code> in Oleo.

<br><dt><code>ignore-interrupts</code>
<dd><code>-i</code> in <code>tee</code>.

<br><dt><code>ignore-matching-lines</code>
<dd><code>-I</code> in <code>diff</code>.

<br><dt><code>ignore-space-change</code>
<dd><code>-b</code> in <code>diff</code>.

<br><dt><code>ignore-zeros</code>
<dd><code>-i</code> in <code>tar</code>.

<br><dt><code>include</code>
<dd><code>-i</code> in <code>etags</code>;
<code>-I</code> in <code>m4</code>.

<br><dt><code>include-dir</code>
<dd><code>-I</code> in Make.

<br><dt><code>incremental</code>
<dd><code>-G</code> in <code>tar</code>.

<br><dt><code>info</code>
<dd><code>-i</code>, <code>-l</code>, and <code>-m</code> in Finger.

<br><dt><code>initial</code>
<dd><code>-i</code> in <code>expand</code>.

<br><dt><code>initial-tab</code>
<dd><code>-T</code> in <code>diff</code>.

<br><dt><code>inode</code>
<dd><code>-i</code> in <code>ls</code>.

<br><dt><code>interactive</code>
<dd><code>-i</code> in <code>cp</code>, <code>ln</code>, <code>mv</code>, <code>rm</code>;
<code>-e</code> in <code>m4</code>;
<code>-p</code> in <code>xargs</code>;
<code>-w</code> in <code>tar</code>.

<br><dt><code>intermix-type</code>
<dd><code>-p</code> in <code>shar</code>.

<br><dt><code>jobs</code>
<dd><code>-j</code> in Make.

<br><dt><code>just-print</code>
<dd><code>-n</code> in Make.

<br><dt><code>keep-going</code>
<dd><code>-k</code> in Make.

<br><dt><code>keep-files</code>
<dd><code>-k</code> in <code>csplit</code>.

<br><dt><code>kilobytes</code>
<dd><code>-k</code> in <code>du</code> and <code>ls</code>.

<br><dt><code>language</code>
<dd><code>-l</code> in <code>etags</code>.

<br><dt><code>less-mode</code>
<dd><code>-l</code> in <code>wdiff</code>.

<br><dt><code>level-for-gzip</code>
<dd><code>-g</code> in <code>shar</code>.

<br><dt><code>line-bytes</code>
<dd><code>-C</code> in <code>split</code>.

<br><dt><code>lines</code>
<dd>Used in <code>split</code>, <code>head</code>, and <code>tail</code>.

<br><dt><code>link</code>
<dd><code>-l</code> in <code>cpio</code>.

<br><dt><code>lint</code>
<dt><code>lint-old</code>
<dd>Used in <code>gawk</code>.

<br><dt><code>list</code>
<dd><code>-t</code> in <code>cpio</code>;
<code>-l</code> in <code>recode</code>.

<br><dt><code>list</code>
<dd><code>-t</code> in <code>tar</code>.

<br><dt><code>literal</code>
<dd><code>-N</code> in <code>ls</code>.

<br><dt><code>load-average</code>
<dd><code>-l</code> in Make.

<br><dt><code>login</code>
<dd>Used in <code>su</code>.

<br><dt><code>machine</code>
<dd>No listing of which programs already use this;
someone should check to
see if any actually do, and tell <a href="mailto:gnu@gnu.org">gnu@gnu.org</a>.

<br><dt><code>macro-name</code>
<dd><code>-M</code> in <code>ptx</code>.

<br><dt><code>mail</code>
<dd><code>-m</code> in <code>hello</code> and <code>uname</code>.

<br><dt><code>make-directories</code>
<dd><code>-d</code> in <code>cpio</code>.

<br><dt><code>makefile</code>
<dd><code>-f</code> in Make.

<br><dt><code>mapped</code>
<dd>Used in GDB.

<br><dt><code>max-args</code>
<dd><code>-n</code> in <code>xargs</code>.

<br><dt><code>max-chars</code>
<dd><code>-n</code> in <code>xargs</code>.

<br><dt><code>max-lines</code>
<dd><code>-l</code> in <code>xargs</code>.

<br><dt><code>max-load</code>
<dd><code>-l</code> in Make.

<br><dt><code>max-procs</code>
<dd><code>-P</code> in <code>xargs</code>.

<br><dt><code>mesg</code>
<dd><code>-T</code> in <code>who</code>.

<br><dt><code>message</code>
<dd><code>-T</code> in <code>who</code>.

<br><dt><code>minimal</code>
<dd><code>-d</code> in <code>diff</code>.

<br><dt><code>mixed-uuencode</code>
<dd><code>-M</code> in <code>shar</code>.

<br><dt><code>mode</code>
<dd><code>-m</code> in <code>install</code>, <code>mkdir</code>, and <code>mkfifo</code>.

<br><dt><code>modification-time</code>
<dd><code>-m</code> in <code>tar</code>.

<br><dt><code>multi-volume</code>
<dd><code>-M</code> in <code>tar</code>.

<br><dt><code>name-prefix</code>
<dd><code>-a</code> in Bison.

<br><dt><code>nesting-limit</code>
<dd><code>-L</code> in <code>m4</code>.

<br><dt><code>net-headers</code>
<dd><code>-a</code> in <code>shar</code>.

<br><dt><code>new-file</code>
<dd><code>-W</code> in Make.

<br><dt><code>no-builtin-rules</code>
<dd><code>-r</code> in Make.

<br><dt><code>no-character-count</code>
<dd><code>-w</code> in <code>shar</code>.

<br><dt><code>no-check-existing</code>
<dd><code>-x</code> in <code>shar</code>.

<br><dt><code>no-common</code>
<dd><code>-3</code> in <code>wdiff</code>.

<br><dt><code>no-create</code>
<dd><code>-c</code> in <code>touch</code>.

<br><dt><code>no-defines</code>
<dd><code>-D</code> in <code>etags</code>.

<br><dt><code>no-deleted</code>
<dd><code>-1</code> in <code>wdiff</code>.

<br><dt><code>no-dereference</code>
<dd><code>-d</code> in <code>cp</code>.

<br><dt><code>no-inserted</code>
<dd><code>-2</code> in <code>wdiff</code>.

<br><dt><code>no-keep-going</code>
<dd><code>-S</code> in Make.

<br><dt><code>no-lines</code>
<dd><code>-l</code> in Bison.

<br><dt><code>no-piping</code>
<dd><code>-P</code> in <code>shar</code>.

<br><dt><code>no-prof</code>
<dd><code>-e</code> in <code>gprof</code>.

<br><dt><code>no-regex</code>
<dd><code>-R</code> in <code>etags</code>.

<br><dt><code>no-sort</code>
<dd><code>-p</code> in <code>nm</code>.

<br><dt><code>no-split</code>
<dd>Used in <code>makeinfo</code>.

<br><dt><code>no-static</code>
<dd><code>-a</code> in <code>gprof</code>.

<br><dt><code>no-time</code>
<dd><code>-E</code> in <code>gprof</code>.

<br><dt><code>no-timestamp</code>
<dd><code>-m</code> in <code>shar</code>.

<br><dt><code>no-validate</code>
<dd>Used in <code>makeinfo</code>.

<br><dt><code>no-wait</code>
<dd>Used in <code>emacsclient</code>.

<br><dt><code>no-warn</code>
<dd>Used in various programs to inhibit warnings.

<br><dt><code>node</code>
<dd><code>-n</code> in <code>info</code>.

<br><dt><code>nodename</code>
<dd><code>-n</code> in <code>uname</code>.

<br><dt><code>nonmatching</code>
<dd><code>-f</code> in <code>cpio</code>.

<br><dt><code>nstuff</code>
<dd><code>-n</code> in <code>objdump</code>.

<br><dt><code>null</code>
<dd><code>-0</code> in <code>xargs</code>.

<br><dt><code>number</code>
<dd><code>-n</code> in <code>cat</code>.

<br><dt><code>number-nonblank</code>
<dd><code>-b</code> in <code>cat</code>.

<br><dt><code>numeric-sort</code>
<dd><code>-n</code> in <code>nm</code>.

<br><dt><code>numeric-uid-gid</code>
<dd><code>-n</code> in <code>cpio</code> and <code>ls</code>.

<br><dt><code>nx</code>
<dd>Used in GDB.

<br><dt><code>old-archive</code>
<dd><code>-o</code> in <code>tar</code>.

<br><dt><code>old-file</code>
<dd><code>-o</code> in Make.

<br><dt><code>one-file-system</code>
<dd><code>-l</code> in <code>tar</code>, <code>cp</code>, and <code>du</code>.

<br><dt><code>only-file</code>
<dd><code>-o</code> in <code>ptx</code>.

<br><dt><code>only-prof</code>
<dd><code>-f</code> in <code>gprof</code>.

<br><dt><code>only-time</code>
<dd><code>-F</code> in <code>gprof</code>.

<br><dt><code>output</code>
<dd>In various programs, specify the output file name.

<br><dt><code>output-prefix</code>
<dd><code>-o</code> in <code>shar</code>.

<br><dt><code>override</code>
<dd><code>-o</code> in <code>rm</code>.

<br><dt><code>overwrite</code>
<dd><code>-c</code> in <code>unshar</code>.

<br><dt><code>owner</code>
<dd><code>-o</code> in <code>install</code>.

<br><dt><code>paginate</code>
<dd><code>-l</code> in <code>diff</code>.

<br><dt><code>paragraph-indent</code>
<dd>Used in <code>makeinfo</code>.

<br><dt><code>parents</code>
<dd><code>-p</code> in <code>mkdir</code> and <code>rmdir</code>.

<br><dt><code>pass-all</code>
<dd><code>-p</code> in <code>ul</code>.

<br><dt><code>pass-through</code>
<dd><code>-p</code> in <code>cpio</code>.

<br><dt><code>port</code>
<dd><code>-P</code> in <code>finger</code>.

<br><dt><code>portability</code>
<dd><code>-c</code> in <code>cpio</code> and <code>tar</code>.

<br><dt><code>posix</code>
<dd>Used in <code>gawk</code>.

<br><dt><code>prefix-builtins</code>
<dd><code>-P</code> in <code>m4</code>.

<br><dt><code>prefix</code>
<dd><code>-f</code> in <code>csplit</code>.

<br><dt><code>preserve</code>
<dd>Used in <code>tar</code> and <code>cp</code>.

<br><dt><code>preserve-environment</code>
<dd><code>-p</code> in <code>su</code>.

<br><dt><code>preserve-modification-time</code>
<dd><code>-m</code> in <code>cpio</code>.

<br><dt><code>preserve-order</code>
<dd><code>-s</code> in <code>tar</code>.

<br><dt><code>preserve-permissions</code>
<dd><code>-p</code> in <code>tar</code>.

<br><dt><code>print</code>
<dd><code>-l</code> in <code>diff</code>.

<br><dt><code>print-chars</code>
<dd><code>-L</code> in <code>cmp</code>.

<br><dt><code>print-data-base</code>
<dd><code>-p</code> in Make.

<br><dt><code>print-directory</code>
<dd><code>-w</code> in Make.

<br><dt><code>print-file-name</code>
<dd><code>-o</code> in <code>nm</code>.

<br><dt><code>print-symdefs</code>
<dd><code>-s</code> in <code>nm</code>.

<br><dt><code>printer</code>
<dd><code>-p</code> in <code>wdiff</code>.

<br><dt><code>prompt</code>
<dd><code>-p</code> in <code>ed</code>.

<br><dt><code>query-user</code>
<dd><code>-X</code> in <code>shar</code>.

<br><dt><code>question</code>
<dd><code>-q</code> in Make.

<br><dt><code>quiet</code>
<dd>Used in many programs to inhibit the usual output.  <strong>Note:</strong> every
program accepting <code>--quiet</code> should accept <code>--silent</code> as a
synonym.

<br><dt><code>quiet-unshar</code>
<dd><code>-Q</code> in <code>shar</code>

<br><dt><code>quote-name</code>
<dd><code>-Q</code> in <code>ls</code>.

<br><dt><code>rcs</code>
<dd><code>-n</code> in <code>diff</code>.

<br><dt><code>re-interval</code>
<dd>Used in <code>gawk</code>.

<br><dt><code>read-full-blocks</code>
<dd><code>-B</code> in <code>tar</code>.

<br><dt><code>readnow</code>
<dd>Used in GDB.

<br><dt><code>recon</code>
<dd><code>-n</code> in Make.

<br><dt><code>record-number</code>
<dd><code>-R</code> in <code>tar</code>.

<br><dt><code>recursive</code>
<dd>Used in <code>chgrp</code>, <code>chown</code>, <code>cp</code>, <code>ls</code>, <code>diff</code>,
and <code>rm</code>.

<br><dt><code>reference-limit</code>
<dd>Used in <code>makeinfo</code>.

<br><dt><code>references</code>
<dd><code>-r</code> in <code>ptx</code>.

<br><dt><code>regex</code>
<dd><code>-r</code> in <code>tac</code> and <code>etags</code>.

<br><dt><code>release</code>
<dd><code>-r</code> in <code>uname</code>.

<br><dt><code>reload-state</code>
<dd><code>-R</code> in <code>m4</code>.

<br><dt><code>relocation</code>
<dd><code>-r</code> in <code>objdump</code>.

<br><dt><code>rename</code>
<dd><code>-r</code> in <code>cpio</code>.

<br><dt><code>replace</code>
<dd><code>-i</code> in <code>xargs</code>.

<br><dt><code>report-identical-files</code>
<dd><code>-s</code> in <code>diff</code>.

<br><dt><code>reset-access-time</code>
<dd><code>-a</code> in <code>cpio</code>.

<br><dt><code>reverse</code>
<dd><code>-r</code> in <code>ls</code> and <code>nm</code>.

<br><dt><code>reversed-ed</code>
<dd><code>-f</code> in <code>diff</code>.

<br><dt><code>right-side-defs</code>
<dd><code>-R</code> in <code>ptx</code>.

<br><dt><code>same-order</code>
<dd><code>-s</code> in <code>tar</code>.

<br><dt><code>same-permissions</code>
<dd><code>-p</code> in <code>tar</code>.

<br><dt><code>save</code>
<dd><code>-g</code> in <code>stty</code>.

<br><dt><code>se</code>
<dd>Used in GDB.

<br><dt><code>sentence-regexp</code>
<dd><code>-S</code> in <code>ptx</code>.

<br><dt><code>separate-dirs</code>
<dd><code>-S</code> in <code>du</code>.

<br><dt><code>separator</code>
<dd><code>-s</code> in <code>tac</code>.

<br><dt><code>sequence</code>
<dd>Used by <code>recode</code> to chose files or pipes for sequencing passes.

<br><dt><code>shell</code>
<dd><code>-s</code> in <code>su</code>.

<br><dt><code>show-all</code>
<dd><code>-A</code> in <code>cat</code>.

<br><dt><code>show-c-function</code>
<dd><code>-p</code> in <code>diff</code>.

<br><dt><code>show-ends</code>
<dd><code>-E</code> in <code>cat</code>.

<br><dt><code>show-function-line</code>
<dd><code>-F</code> in <code>diff</code>.

<br><dt><code>show-tabs</code>
<dd><code>-T</code> in <code>cat</code>.

<br><dt><code>silent</code>
<dd>Used in many programs to inhibit the usual output. 
<strong>Note:</strong> every program accepting
<code>--silent</code> should accept <code>--quiet</code> as a synonym.

<br><dt><code>size</code>
<dd><code>-s</code> in <code>ls</code>.

<br><dt><code>sort</code>
<dd>Used in <code>ls</code>.

<br><dt><code>source</code>
<dd><code>-W source</code> in <code>gawk</code>.

<br><dt><code>sparse</code>
<dd><code>-S</code> in <code>tar</code>.

<br><dt><code>speed-large-files</code>
<dd><code>-H</code> in <code>diff</code>.

<br><dt><code>split-at</code>
<dd><code>-E</code> in <code>unshar</code>.

<br><dt><code>split-size-limit</code>
<dd><code>-L</code> in <code>shar</code>.

<br><dt><code>squeeze-blank</code>
<dd><code>-s</code> in <code>cat</code>.

<br><dt><code>start-delete</code>
<dd><code>-w</code> in <code>wdiff</code>.

<br><dt><code>start-insert</code>
<dd><code>-y</code> in <code>wdiff</code>.

<br><dt><code>starting-file</code>
<dd>Used in <code>tar</code> and <code>diff</code> to specify which file within
a directory to start processing with.

<br><dt><code>statistics</code>
<dd><code>-s</code> in <code>wdiff</code>.

<br><dt><code>stdin-file-list</code>
<dd><code>-S</code> in <code>shar</code>.

<br><dt><code>stop</code>
<dd><code>-S</code> in Make.

<br><dt><code>strict</code>
<dd><code>-s</code> in <code>recode</code>.

<br><dt><code>strip</code>
<dd><code>-s</code> in <code>install</code>.

<br><dt><code>strip-all</code>
<dd><code>-s</code> in <code>strip</code>.

<br><dt><code>strip-debug</code>
<dd><code>-S</code> in <code>strip</code>.

<br><dt><code>submitter</code>
<dd><code>-s</code> in <code>shar</code>.

<br><dt><code>suffix</code>
<dd><code>-S</code> in <code>cp</code>, <code>ln</code>, <code>mv</code>.

<br><dt><code>suffix-format</code>
<dd><code>-b</code> in <code>csplit</code>.

<br><dt><code>sum</code>
<dd><code>-s</code> in <code>gprof</code>.

<br><dt><code>summarize</code>
<dd><code>-s</code> in <code>du</code>.

<br><dt><code>symbolic</code>
<dd><code>-s</code> in <code>ln</code>.

<br><dt><code>symbols</code>
<dd>Used in GDB and <code>objdump</code>.

<br><dt><code>synclines</code>
<dd><code>-s</code> in <code>m4</code>.

<br><dt><code>sysname</code>
<dd><code>-s</code> in <code>uname</code>.

<br><dt><code>tabs</code>
<dd><code>-t</code> in <code>expand</code> and <code>unexpand</code>.

<br><dt><code>tabsize</code>
<dd><code>-T</code> in <code>ls</code>.

<br><dt><code>terminal</code>
<dd><code>-T</code> in <code>tput</code> and <code>ul</code>. 
<code>-t</code> in <code>wdiff</code>.

<br><dt><code>text</code>
<dd><code>-a</code> in <code>diff</code>.

<br><dt><code>text-files</code>
<dd><code>-T</code> in <code>shar</code>.

<br><dt><code>time</code>
<dd>Used in <code>ls</code> and <code>touch</code>.

<br><dt><code>to-stdout</code>
<dd><code>-O</code> in <code>tar</code>.

<br><dt><code>total</code>
<dd><code>-c</code> in <code>du</code>.

<br><dt><code>touch</code>
<dd><code>-t</code> in Make, <code>ranlib</code>, and <code>recode</code>.

<br><dt><code>trace</code>
<dd><code>-t</code> in <code>m4</code>.

<br><dt><code>traditional</code>
<dd><code>-t</code> in <code>hello</code>;
<code>-W traditional</code> in <code>gawk</code>;
<code>-G</code> in <code>ed</code>, <code>m4</code>, and <code>ptx</code>.

<br><dt><code>tty</code>
<dd>Used in GDB.

<br><dt><code>typedefs</code>
<dd><code>-t</code> in <code>ctags</code>.

<br><dt><code>typedefs-and-c++</code>
<dd><code>-T</code> in <code>ctags</code>.

<br><dt><code>typeset-mode</code>
<dd><code>-t</code> in <code>ptx</code>.

<br><dt><code>uncompress</code>
<dd><code>-z</code> in <code>tar</code>.

<br><dt><code>unconditional</code>
<dd><code>-u</code> in <code>cpio</code>.

<br><dt><code>undefine</code>
<dd><code>-U</code> in <code>m4</code>.

<br><dt><code>undefined-only</code>
<dd><code>-u</code> in <code>nm</code>.

<br><dt><code>update</code>
<dd><code>-u</code> in <code>cp</code>, <code>ctags</code>, <code>mv</code>, <code>tar</code>.

<br><dt><code>usage</code>
<dd>Used in <code>gawk</code>; same as <code>--help</code>.

<br><dt><code>uuencode</code>
<dd><code>-B</code> in <code>shar</code>.

<br><dt><code>vanilla-operation</code>
<dd><code>-V</code> in <code>shar</code>.

<br><dt><code>verbose</code>
<dd>Print more information about progress.  Many programs support this.

<br><dt><code>verify</code>
<dd><code>-W</code> in <code>tar</code>.

<br><dt><code>version</code>
<dd>Print the version number.

<br><dt><code>version-control</code>
<dd><code>-V</code> in <code>cp</code>, <code>ln</code>, <code>mv</code>.

<br><dt><code>vgrind</code>
<dd><code>-v</code> in <code>ctags</code>.

<br><dt><code>volume</code>
<dd><code>-V</code> in <code>tar</code>.

<br><dt><code>what-if</code>
<dd><code>-W</code> in Make.

<br><dt><code>whole-size-limit</code>
<dd><code>-l</code> in <code>shar</code>.

<br><dt><code>width</code>
<dd><code>-w</code> in <code>ls</code> and <code>ptx</code>.

<br><dt><code>word-regexp</code>
<dd><code>-W</code> in <code>ptx</code>.

<br><dt><code>writable</code>
<dd><code>-T</code> in <code>who</code>.

<br><dt><code>zeros</code>
<dd><code>-z</code> in <code>gprof</code>. 
</dl>

<p><hr>
Node:<a name="Memory%20Usage">Memory Usage</a>,
Previous:<a rel=previous href="#Option%20Table">Option Table</a>,
Up:<a rel=up href="#Program%20Behavior">Program Behavior</a>
<br>

<h2>Memory Usage</h2>

<p>If it typically uses just a few meg of memory, don't bother making any
effort to reduce memory usage.  For example, if it is impractical for
other reasons to operate on files more than a few meg long, it is
reasonable to read entire input files into core to operate on them.

<p>However, for programs such as <code>cat</code> or <code>tail</code>, that can
usefully operate on very large files, it is important to avoid using a
technique that would artificially limit the size of files it can handle. 
If a program works by lines and could be applied to arbitrary
user-supplied input files, it should keep only a line in memory, because
this is not very hard and users will want to be able to operate on input
files that are bigger than will fit in core all at once.

<p>If your program creates complicated data structures, just make them in
core and give a fatal error if <code>malloc</code> returns zero.

<p><hr>
Node:<a name="Writing%20C">Writing C</a>,
Next:<a rel=next href="#Documentation">Documentation</a>,
Previous:<a rel=previous href="#Program%20Behavior">Program Behavior</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Making The Best Use of C</h1>

<p>This node provides advice on how best to use the C language
when writing GNU software.

<ul>
<li><a href="#Formatting">Formatting</a>:                   Formatting Your Source Code
<li><a href="#Comments">Comments</a>:                     Commenting Your Work
<li><a href="#Syntactic%20Conventions">Syntactic Conventions</a>:        Clean Use of C Constructs
<li><a href="#Names">Names</a>:                        Naming Variables and Functions
<li><a href="#System%20Portability">System Portability</a>:           Portability between different operating systems
<li><a href="#CPU%20Portability">CPU Portability</a>:              Supporting the range of CPU types
<li><a href="#System%20Functions">System Functions</a>:             Portability and ``standard'' library functions
<li><a href="#Internationalization">Internationalization</a>:         Techniques for internationalization
<li><a href="#Mmap">Mmap</a>:                         How you can safely use <code>mmap</code>. 
</ul>

<p><hr>
Node:<a name="Formatting">Formatting</a>,
Next:<a rel=next href="#Comments">Comments</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Formatting Your Source Code</h2>

<p>It is important to put the open-brace that starts the body of a C
function in column zero, and avoid putting any other open-brace or
open-parenthesis or open-bracket in column zero.  Several tools look
for open-braces in column zero to find the beginnings of C functions. 
These tools will not work on code not formatted that way.

<p>It is also important for function definitions to start the name of the
function in column zero.  This helps people to search for function
definitions, and may also help certain tools recognize them.  Thus,
the proper format is this:

<pre>static char *
concat (s1, s2)        /* Name starts in column zero here */
     char *s1, *s2;
{                     /* Open brace in column zero here */
  <small>...</small>
}
</pre>

<p>or, if you want to use <small>ANSI</small> C, format the definition like this:

<pre>static char *
concat (char *s1, char *s2)
{
  <small>...</small>
}
</pre>

<p>In <small>ANSI</small> C, if the arguments don't fit nicely on one line,
split it like this:

<pre>int
lots_of_args (int an_integer, long a_long, short a_short,
              double a_double, float a_float)
<small>...</small>
</pre>

<p>For the body of the function, we prefer code formatted like this:

<pre>if (x &lt; foo (y, z))
  haha = bar[4] + 5;
else
  {
    while (z)
      {
        haha += foo (z, z);
        z--;
      }
    return ++x + bar ();
  }
</pre>

<p>We find it easier to read a program when it has spaces before the
open-parentheses and after the commas.  Especially after the commas.

<p>When you split an expression into multiple lines, split it
before an operator, not after one.  Here is the right way:

<pre>if (foo_this_is_long &amp;&amp; bar &gt; win (x, y, z)
    &amp;&amp; remaining_condition)
</pre>

<p>Try to avoid having two operators of different precedence at the same
level of indentation.  For example, don't write this:

<pre>mode = (inmode[j] == VOIDmode
        || GET_MODE_SIZE (outmode[j]) &gt; GET_MODE_SIZE (inmode[j])
        ? outmode[j] : inmode[j]);
</pre>

<p>Instead, use extra parentheses so that the indentation shows the nesting:

<pre>mode = ((inmode[j] == VOIDmode
         || (GET_MODE_SIZE (outmode[j]) &gt; GET_MODE_SIZE (inmode[j])))
        ? outmode[j] : inmode[j]);
</pre>

<p>Insert extra parentheses so that Emacs will indent the code properly. 
For example, the following indentation looks nice if you do it by hand,
but Emacs would mess it up:

<pre>v = rup-&gt;ru_utime.tv_sec*1000 + rup-&gt;ru_utime.tv_usec/1000
    + rup-&gt;ru_stime.tv_sec*1000 + rup-&gt;ru_stime.tv_usec/1000;
</pre>

<p>But adding a set of parentheses solves the problem:

<pre>v = (rup-&gt;ru_utime.tv_sec*1000 + rup-&gt;ru_utime.tv_usec/1000
     + rup-&gt;ru_stime.tv_sec*1000 + rup-&gt;ru_stime.tv_usec/1000);
</pre>

<p>Format do-while statements like this:

<pre>do
  {
    a = foo (a);
  }
while (a &gt; 0);
</pre>

<p>Please use formfeed characters (control-L) to divide the program into
pages at logical places (but not within a function).  It does not matter
just how long the pages are, since they do not have to fit on a printed
page.  The formfeeds should appear alone on lines by themselves.

<p><hr>
Node:<a name="Comments">Comments</a>,
Next:<a rel=next href="#Syntactic%20Conventions">Syntactic Conventions</a>,
Previous:<a rel=previous href="#Formatting">Formatting</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Commenting Your Work</h2>

<p>Every program should start with a comment saying briefly what it is for. 
Example: <code>fmt - filter for simple filling of text</code>.

<p>Please write the comments in a GNU program in English, because English
is the one language that nearly all programmers in all countries can
read.  If you do not write English well, please write comments in
English as well as you can, then ask other people to help rewrite them. 
If you can't write comments in English, please find someone to work with
you and translate your comments into English.

<p>Please put a comment on each function saying what the function does,
what sorts of arguments it gets, and what the possible values of
arguments mean and are used for.  It is not necessary to duplicate in
words the meaning of the C argument declarations, if a C type is being
used in its customary fashion.  If there is anything nonstandard about
its use (such as an argument of type <code>char *</code> which is really the
address of the second character of a string, not the first), or any
possible values that would not work the way one would expect (such as,
that strings containing newlines are not guaranteed to work), be sure
to say so.

<p>Also explain the significance of the return value, if there is one.

<p>Please put two spaces after the end of a sentence in your comments, so
that the Emacs sentence commands will work.  Also, please write
complete sentences and capitalize the first word.  If a lower-case
identifier comes at the beginning of a sentence, don't capitalize it! 
Changing the spelling makes it a different identifier.  If you don't
like starting a sentence with a lower case letter, write the sentence
differently (e.g., "The identifier lower-case is <small>...</small>").

<p>The comment on a function is much clearer if you use the argument
names to speak about the argument values.  The variable name itself
should be lower case, but write it in upper case when you are speaking
about the value rather than the variable itself.  Thus, "the inode
number NODE_NUM" rather than "an inode".

<p>There is usually no purpose in restating the name of the function in
the comment before it, because the reader can see that for himself. 
There might be an exception when the comment is so long that the function
itself would be off the bottom of the screen.

<p>There should be a comment on each static variable as well, like this:

<pre>/* Nonzero means truncate lines in the display;
   zero means continue them.  */
int truncate_lines;
</pre>

<p>Every <code>#endif</code> should have a comment, except in the case of short
conditionals (just a few lines) that are not nested.  The comment should
state the condition of the conditional that is ending, <em>including
its sense</em>.  <code>#else</code> should have a comment describing the condition
<em>and sense</em> of the code that follows.  For example:

<pre>#ifdef foo
  <small>...</small>
#else /* not foo */
  <small>...</small>
#endif /* not foo */
#ifdef foo
  <small>...</small>
#endif /* foo */
</pre>

<p>but, by contrast, write the comments this way for a <code>#ifndef</code>:

<pre>#ifndef foo
  <small>...</small>
#else /* foo */
  <small>...</small>
#endif /* foo */
#ifndef foo
  <small>...</small>
#endif /* not foo */
</pre>

<p><hr>
Node:<a name="Syntactic%20Conventions">Syntactic Conventions</a>,
Next:<a rel=next href="#Names">Names</a>,
Previous:<a rel=previous href="#Comments">Comments</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Clean Use of C Constructs</h2>

<p>Please explicitly declare all arguments to functions. 
Don't omit them just because they are <code>int</code>s.

<p>Declarations of external functions and functions to appear later in the
source file should all go in one place near the beginning of the file
(somewhere before the first function definition in the file), or else
should go in a header file.  Don't put <code>extern</code> declarations inside
functions.

<p>It used to be common practice to use the same local variables (with
names like <code>tem</code>) over and over for different values within one
function.  Instead of doing this, it is better declare a separate local
variable for each distinct purpose, and give it a name which is
meaningful.  This not only makes programs easier to understand, it also
facilitates optimization by good compilers.  You can also move the
declaration of each local variable into the smallest scope that includes
all its uses.  This makes the program even cleaner.

<p>Don't use local variables or parameters that shadow global identifiers.

<p>Don't declare multiple variables in one declaration that spans lines. 
Start a new declaration on each line, instead.  For example, instead
of this:

<pre>int    foo,
       bar;
</pre>

<p>write either this:

<pre>int foo, bar;
</pre>

<p>or this:

<pre>int foo;
int bar;
</pre>

<p>(If they are global variables, each should have a comment preceding it
anyway.)

<p>When you have an <code>if</code>-<code>else</code> statement nested in another
<code>if</code> statement, always put braces around the <code>if</code>-<code>else</code>. 
Thus, never write like this:

<pre>if (foo)
  if (bar)
    win ();
  else
    lose ();
</pre>

<p>always like this:

<pre>if (foo)
  {
    if (bar)
      win ();
    else
      lose ();
  }
</pre>

<p>If you have an <code>if</code> statement nested inside of an <code>else</code>
statement, either write <code>else if</code> on one line, like this,

<pre>if (foo)
  <small>...</small>
else if (bar)
  <small>...</small>
</pre>

<p>with its <code>then</code>-part indented like the preceding <code>then</code>-part,
or write the nested <code>if</code> within braces like this:

<pre>if (foo)
  <small>...</small>
else
  {
    if (bar)
      <small>...</small>
  }
</pre>

<p>Don't declare both a structure tag and variables or typedefs in the
same declaration.  Instead, declare the structure tag separately
and then use it to declare the variables or typedefs.

<p>Try to avoid assignments inside <code>if</code>-conditions.  For example,
don't write this:

<pre>if ((foo = (char *) malloc (sizeof *foo)) == 0)
  fatal ("virtual memory exhausted");
</pre>

<p>instead, write this:

<pre>foo = (char *) malloc (sizeof *foo);
if (foo == 0)
  fatal ("virtual memory exhausted");
</pre>

<p>Don't make the program ugly to placate <code>lint</code>.  Please don't insert any
casts to <code>void</code>.  Zero without a cast is perfectly fine as a null
pointer constant, except when calling a varargs function.

<p><hr>
Node:<a name="Names">Names</a>,
Next:<a rel=next href="#System%20Portability">System Portability</a>,
Previous:<a rel=previous href="#Syntactic%20Conventions">Syntactic Conventions</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Naming Variables and Functions</h2>

<p>The names of global variables and functions in a program serve as
comments of a sort.  So don't choose terse names--instead, look for
names that give useful information about the meaning of the variable or
function.  In a GNU program, names should be English, like other
comments.

<p>Local variable names can be shorter, because they are used only within
one context, where (presumably) comments explain their purpose.

<p>Please use underscores to separate words in a name, so that the Emacs
word commands can be useful within them.  Stick to lower case; reserve
upper case for macros and <code>enum</code> constants, and for name-prefixes
that follow a uniform convention.

<p>For example, you should use names like <code>ignore_space_change_flag</code>;
don't use names like <code>iCantReadThis</code>.

<p>Variables that indicate whether command-line options have been
specified should be named after the meaning of the option, not after
the option-letter.  A comment should state both the exact meaning of
the option and its letter.  For example,

<pre>/* Ignore changes in horizontal whitespace (-b).  */
int ignore_space_change_flag;
</pre>

<p>When you want to define names with constant integer values, use
<code>enum</code> rather than <code>#define</code>.  GDB knows about enumeration
constants.

<p>Use file names of 14 characters or less, to avoid creating gratuitous
problems on older System V systems.  You can use the program
<code>doschk</code> to test for this.  <code>doschk</code> also tests for potential
name conflicts if the files were loaded onto an MS-DOS file
system--something you may or may not care about.

<p><hr>
Node:<a name="System%20Portability">System Portability</a>,
Next:<a rel=next href="#CPU%20Portability">CPU Portability</a>,
Previous:<a rel=previous href="#Names">Names</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Portability between System Types</h2>

<p>In the Unix world, "portability" refers to porting to different Unix
versions.  For a GNU program, this kind of portability is desirable, but
not paramount.

<p>The primary purpose of GNU software is to run on top of the GNU kernel,
compiled with the GNU C compiler, on various types of <small>CPU</small>.  The
amount and kinds of variation among GNU systems on different <small>CPU</small>s
will be comparable to the variation among Linux-based GNU systems or
among BSD systems today.  So the kinds of portability that are absolutely
necessary are quite limited.

<p>But many users do run GNU software on non-GNU Unix or Unix-like systems. 
So supporting a variety of Unix-like systems is desirable, although not
paramount.

<p>The easiest way to achieve portability to most Unix-like systems is to
use Autoconf.  It's unlikely that your program needs to know more
information about the host platform than Autoconf can provide, simply
because most of the programs that need such knowledge have already been
written.

<p>Avoid using the format of semi-internal data bases (e.g., directories)
when there is a higher-level alternative (<code>readdir</code>).

<p>As for systems that are not like Unix, such as MSDOS, Windows, the
Macintosh, VMS, and MVS, supporting them is usually so much work that it
is better if you don't.

<p>The planned GNU kernel is not finished yet, but you can tell which
facilities it will provide by looking at the GNU C Library Manual.  The
GNU kernel is based on Mach, so the features of Mach will also be
available.  However, if you use Mach features, you'll probably have
trouble debugging your program today.

<p><hr>
Node:<a name="CPU%20Portability">CPU Portability</a>,
Next:<a rel=next href="#System%20Functions">System Functions</a>,
Previous:<a rel=previous href="#System%20Portability">System Portability</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Portability between <small>CPU</small>s</h2>

<p>Even GNU systems will differ because of differences among <small>CPU</small>
types--for example, difference in byte ordering and alignment
requirements.  It is absolutely essential to handle these differences. 
However, don't make any effort to cater to the possibility that an
<code>int</code> will be less than 32 bits.  We don't support 16-bit machines
in GNU.

<p>Don't assume that the address of an <code>int</code> object is also the
address of its least-significant byte.  This is false on big-endian
machines.  Thus, don't make the following mistake:

<pre>int c;
<small>...</small>
while ((c = getchar()) != EOF)
  write(file_descriptor, &amp;c, 1);
</pre>

<p>When calling functions, you need not worry about the difference between
pointers of various types, or between pointers and integers.  On most
machines, there's no difference anyway.  As for the few machines where
there is a difference, all of them support <small>ANSI</small> C, so you can use
prototypes (conditionalized to be active only in <small>ANSI</small> C) to make
the code work on those systems.

<p>In certain cases, it is ok to pass integer and pointer arguments
indiscriminately to the same function, and use no prototype on any
system.  For example, many GNU programs have error-reporting functions
that pass their arguments along to <code>printf</code> and friends:

<pre>error (s, a1, a2, a3)
     char *s;
     int a1, a2, a3;
{
  fprintf (stderr, "error: ");
  fprintf (stderr, s, a1, a2, a3);
}
</pre>

<p>In practice, this works on all machines, and it is much simpler than any
"correct" alternative.  Be sure <em>not</em> to use a prototype
for such functions.

<p>However, avoid casting pointers to integers unless you really need to. 
These assumptions really reduce portability, and in most programs they
are easy to avoid.  In the cases where casting pointers to integers is
essential--such as, a Lisp interpreter which stores type information as
well as an address in one word--it is ok to do so, but you'll have to
make explicit provisions to handle different word sizes.

<p><hr>
Node:<a name="System%20Functions">System Functions</a>,
Next:<a rel=next href="#Internationalization">Internationalization</a>,
Previous:<a rel=previous href="#CPU%20Portability">CPU Portability</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Calling System Functions</h2>

<p>C implementations differ substantially.  <small>ANSI</small> C reduces but does not
eliminate the incompatibilities; meanwhile, many users wish to compile
GNU software with pre-<small>ANSI</small> compilers.  This chapter gives
recommendations for how to use the more or less standard C library
functions to avoid unnecessary loss of portability.

<ul>
<li>Don't use the value of <code>sprintf</code>.  It returns the number of
characters written on some systems, but not on all systems.

<li><code>main</code> should be declared to return type <code>int</code>.  It should
terminate either by calling <code>exit</code> or by returning the integer
status code; make sure it cannot ever return an undefined value.

<li>Don't declare system functions explicitly.

<p>Almost any declaration for a system function is wrong on some system. 
To minimize conflicts, leave it to the system header files to declare
system functions.  If the headers don't declare a function, let it
remain undeclared.

<p>While it may seem unclean to use a function without declaring it, in
practice this works fine for most system library functions on the
systems where this really happens; thus, the disadvantage is only
theoretical.  By contrast, actual declarations have frequently caused
actual conflicts.

</p><li>If you must declare a system function, don't specify the argument types. 
Use an old-style declaration, not an <small>ANSI</small> prototype.  The more you
specify about the function, the more likely a conflict.

<li>In particular, don't unconditionally declare <code>malloc</code> or
<code>realloc</code>.

<p>Most GNU programs use those functions just once, in functions
conventionally named <code>xmalloc</code> and <code>xrealloc</code>.  These
functions call <code>malloc</code> and <code>realloc</code>, respectively, and
check the results.

<p>Because <code>xmalloc</code> and <code>xrealloc</code> are defined in your program,
you can declare them in other files without any risk of type conflict.

<p>On most systems, <code>int</code> is the same length as a pointer; thus, the
calls to <code>malloc</code> and <code>realloc</code> work fine.  For the few
exceptional systems (mostly 64-bit machines), you can use
<strong>conditionalized</strong> declarations of <code>malloc</code> and
<code>realloc</code>--or put these declarations in configuration files
specific to those systems.

</p><li>The string functions require special treatment.  Some Unix systems have
a header file <code>string.h</code>; others have <code>strings.h</code>.  Neither
file name is portable.  There are two things you can do: use Autoconf to
figure out which file to include, or don't include either file.

<li>If you don't include either strings file, you can't get declarations for
the string functions from the header file in the usual way.

<p>That causes less of a problem than you might think.  The newer <small>ANSI</small>
string functions should be avoided anyway because many systems still
don't support them.  The string functions you can use are these:

<pre>strcpy   strncpy   strcat   strncat
strlen   strcmp    strncmp
strchr   strrchr
</pre>

<p>The copy and concatenate functions work fine without a declaration as
long as you don't use their values.  Using their values without a
declaration fails on systems where the width of a pointer differs from
the width of <code>int</code>, and perhaps in other cases.  It is trivial to
avoid using their values, so do that.

<p>The compare functions and <code>strlen</code> work fine without a declaration
on most systems, possibly all the ones that GNU software runs on. 
You may find it necessary to declare them <strong>conditionally</strong> on a
few systems.

<p>The search functions must be declared to return <code>char *</code>.  Luckily,
there is no variation in the data type they return.  But there is
variation in their names.  Some systems give these functions the names
<code>index</code> and <code>rindex</code>; other systems use the names
<code>strchr</code> and <code>strrchr</code>.  Some systems support both pairs of
names, but neither pair works on all systems.

<p>You should pick a single pair of names and use it throughout your
program.  (Nowadays, it is better to choose <code>strchr</code> and
<code>strrchr</code> for new programs, since those are the standard <small>ANSI</small>
names.)  Declare both of those names as functions returning <code>char
*</code>.  On systems which don't support those names, define them as macros
in terms of the other pair.  For example, here is what to put at the
beginning of your file (or in a header) if you want to use the names
<code>strchr</code> and <code>strrchr</code> throughout:

<pre>#ifndef HAVE_STRCHR
#define strchr index
#endif
#ifndef HAVE_STRRCHR
#define strrchr rindex
#endif

char *strchr ();
char *strrchr ();
</pre>
</ul>

<p>Here we assume that <code>HAVE_STRCHR</code> and <code>HAVE_STRRCHR</code> are
macros defined in systems where the corresponding functions exist. 
One way to get them properly defined is to use Autoconf.

<p><hr>
Node:<a name="Internationalization">Internationalization</a>,
Next:<a rel=next href="#Mmap">Mmap</a>,
Previous:<a rel=previous href="#System%20Functions">System Functions</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Internationalization</h2>

<p>GNU has a library called GNU gettext that makes it easy to translate the
messages in a program into various languages.  You should use this
library in every program.  Use English for the messages as they appear
in the program, and let gettext provide the way to translate them into
other languages.

<p>Using GNU gettext involves putting a call to the <code>gettext</code> macro
around each string that might need translation--like this:

<pre>printf (gettext ("Processing file `%s'..."));
</pre>

<p>This permits GNU gettext to replace the string <code>"Processing file
`%s'..."</code> with a translated version.

<p>Once a program uses gettext, please make a point of writing calls to
<code>gettext</code> when you add new strings that call for translation.

<p>Using GNU gettext in a package involves specifying a <dfn>text domain
name</dfn> for the package.  The text domain name is used to separate the
translations for this package from the translations for other packages. 
Normally, the text domain name should be the same as the name of the
package--for example, <code>fileutils</code> for the GNU file utilities.

<p>To enable gettext to work well, avoid writing code that makes
assumptions about the structure of words or sentences.  When you want
the precise text of a sentence to vary depending on the data, use two or
more alternative string constants each containing a complete sentences,
rather than inserting conditionalized words or phrases into a single
sentence framework.

<p>Here is an example of what not to do:

<pre>printf ("%d file%s processed", nfiles,
        nfiles != 1 ? "s" : "");
</pre>

<p>The problem with that example is that it assumes that plurals are made
by adding `s'.  If you apply gettext to the format string, like this,

<pre>printf (gettext ("%d file%s processed"), nfiles,
        nfiles != 1 ? "s" : "");
</pre>

<p>the message can use different words, but it will still be forced to use
`s' for the plural.  Here is a better way:

<pre>printf ((nfiles != 1 ? "%d files processed"
         : "%d file processed"),
        nfiles);
</pre>

<p>This way, you can apply gettext to each of the two strings
independently:

<pre>printf ((nfiles != 1 ? gettext ("%d files processed")
         : gettext ("%d file processed")),
        nfiles);
</pre>

<p>This can be any method of forming the plural of the word for "file", and
also handles languages that require agreement in the word for
"processed".

<p>A similar problem appears at the level of sentence structure with this
code:

<pre>printf ("#  Implicit rule search has%s been done.\n",
        f-&gt;tried_implicit ? "" : " not");
</pre>

<p>Adding <code>gettext</code> calls to this code cannot give correct results for
all languages, because negation in some languages requires adding words
at more than one place in the sentence.  By contrast, adding
<code>gettext</code> calls does the job straightfowardly if the code starts
out like this:

<pre>printf (f-&gt;tried_implicit
        ? "#  Implicit rule search has been done.\n",
        : "#  Implicit rule search has not been done.\n");
</pre>

<p><hr>
Node:<a name="Mmap">Mmap</a>,
Previous:<a rel=previous href="#Internationalization">Internationalization</a>,
Up:<a rel=up href="#Writing%20C">Writing C</a>
<br>

<h2>Mmap</h2>

<p>Don't assume that <code>mmap</code> either works on all files or fails
for all files.  It may work on some files and fail on others.

<p>The proper way to use <code>mmap</code> is to try it on the specific file for
which you want to use it--and if <code>mmap</code> doesn't work, fall back on
doing the job in another way using <code>read</code> and <code>write</code>.

<p>The reason this precaution is needed is that the GNU kernel (the HURD)
provides a user-extensible file system, in which there can be many
different kinds of "ordinary files."  Many of them support
<code>mmap</code>, but some do not.  It is important to make programs handle
all these kinds of files.

<p><hr>
Node:<a name="Documentation">Documentation</a>,
Next:<a rel=next href="#Managing%20Releases">Managing Releases</a>,
Previous:<a rel=previous href="#Writing%20C">Writing C</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Documenting Programs</h1>

<ul>
<li><a href="#GNU%20Manuals">GNU Manuals</a>:                  Writing proper manuals. 
<li><a href="#Manual%20Structure%20Details">Manual Structure Details</a>:     Specific structure conventions. 
<li><a href="#NEWS%20File">NEWS File</a>:                    NEWS files supplement manuals. 
<li><a href="#Change%20Logs">Change Logs</a>:                  Recording Changes
<li><a href="#Man%20Pages">Man Pages</a>:                    Man pages are secondary. 
<li><a href="#Reading%20other%20Manuals">Reading other Manuals</a>:        How far you can go in learning
                                from other manuals. 
</ul>

<p><hr>
Node:<a name="GNU%20Manuals">GNU Manuals</a>,
Next:<a rel=next href="#Manual%20Structure%20Details">Manual Structure Details</a>,
Up:<a rel=up href="#Documentation">Documentation</a>
<br>

<h2>GNU Manuals</h2>

<p>The preferred way to document part of the GNU system is to write a
manual in the Texinfo formatting language.  See the Texinfo manual,
either the hardcopy, or the on-line version available through
<code>info</code> or the Emacs Info subsystem (<kbd>C-h i</kbd>).

<p>Programmers often find it most natural to structure the documentation
following the structure of the implementation, which they know.  But
this structure is not necessarily good for explaining how to use the
program; it may be irrelevant and confusing for a user.

<p>At every level, from the sentences in a paragraph to the grouping of
topics into separate manuals, the right way to structure documentation
is according to the concepts and questions that a user will have in mind
when reading it.  Sometimes this structure of ideas matches the
structure of the implementation of the software being documented--but
often they are different.  Often the most important part of learning to
write good documentation is learning to notice when you are structuring
the documentation like the implementation, and think about better
alternatives.

<p>For example, each program in the GNU system probably ought to be
documented in one manual; but this does not mean each program should
have its own manual.  That would be following the structure of the
implementation, rather than the structure that helps the user
understand.

<p>Instead, each manual should cover a coherent <em>topic</em>.  For example,
instead of a manual for <code>diff</code> and a manual for <code>diff3</code>, we
have one manual for "comparison of files" which covers both of those
programs, as well as <code>cmp</code>.  By documenting these programs
together, we can make the whole subject clearer.

<p>The manual which discusses a program should document all of the
program's command-line options and all of its commands.  It should give
examples of their use.  But don't organize the manual as a list of
features.  Instead, organize it logically, by subtopics.  Address the
questions that a user will ask when thinking about the job that the
program does.

<p>In general, a GNU manual should serve both as tutorial and reference. 
It should be set up for convenient access to each topic through Info,
and for reading straight through (appendixes aside).  A GNU manual
should give a good introduction to a beginner reading through from the
start, and should also provide all the details that hackers want.

<p>That is not as hard as it first sounds.  Arrange each chapter as a
logical breakdown of its topic, but order the sections, and write their
text, so that reading the chapter straight through makes sense.  Do
likewise when structuring the book into chapters, and when structuring a
section into paragraphs.  The watchword is, <em>at each point, address
the most fundamental and important issue raised by the preceding text.</em>

<p>If necessary, add extra chapters at the beginning of the manual which
are purely tutorial and cover the basics of the subject.  These provide
the framework for a beginner to understand the rest of the manual.  The
Bison manual provides a good example of how to do this.

<p>Don't use Unix man pages as a model for how to write GNU documentation;
most of them are terse, badly structured, and give inadequate
explanation of the underlying concepts.  (There are, of course
exceptions.)  Also Unix man pages use a particular format which is
different from what we use in GNU manuals.

<p>Please do not use the term "pathname" that is used in Unix
documentation; use "file name" (two words) instead.  We use the term
"path" only for search paths, which are lists of file names.

<p>Please do not use the term "illegal" to refer to erroneous input to a
computer program.  Please use "invalid" for this, and reserve the term
"illegal" for violations of law.

<p><hr>
Node:<a name="Manual%20Structure%20Details">Manual Structure Details</a>,
Next:<a rel=next href="#NEWS%20File">NEWS File</a>,
Previous:<a rel=previous href="#GNU%20Manuals">GNU Manuals</a>,
Up:<a rel=up href="#Documentation">Documentation</a>
<br>

<h2>Manual Structure Details</h2>

<p>The title page of the manual should state the version of the programs or
packages documented in the manual.  The Top node of the manual should
also contain this information.  If the manual is changing more
frequently than or independent of the program, also state a version
number for the manual in both of these places.

<p>Each program documented in the manual should should have a node named
<code><var>program</var> Invocation</code> or <code>Invoking <var>program</var></code>.  This
node (together with its subnodes, if any) should describe the program's
command line arguments and how to run it (the sort of information people
would look in a man page for).  Start with an <code>@example</code>
containing a template for all the options and arguments that the program
uses.

<p>Alternatively, put a menu item in some menu whose item name fits one of
the above patterns.  This identifies the node which that item points to
as the node for this purpose, regardless of the node's actual name.

<p>There will be automatic features for specifying a program name and
quickly reading just this part of its manual.

<p>If one manual describes several programs, it should have such a node for
each program described.

<p><hr>
Node:<a name="NEWS%20File">NEWS File</a>,
Next:<a rel=next href="#Change%20Logs">Change Logs</a>,
Previous:<a rel=previous href="#Manual%20Structure%20Details">Manual Structure Details</a>,
Up:<a rel=up href="#Documentation">Documentation</a>
<br>

<h2>The NEWS File</h2>

<p>In addition to its manual, the package should have a file named
<code>NEWS</code> which contains a list of user-visible changes worth
mentioning.  In each new release, add items to the front of the file and
identify the version they pertain to.  Don't discard old items; leave
them in the file after the newer items.  This way, a user upgrading from
any previous version can see what is new.

<p>If the <code>NEWS</code> file gets very long, move some of the older items
into a file named <code>ONEWS</code> and put a note at the end referring the
user to that file.

<p><hr>
Node:<a name="Change%20Logs">Change Logs</a>,
Next:<a rel=next href="#Man%20Pages">Man Pages</a>,
Previous:<a rel=previous href="#NEWS%20File">NEWS File</a>,
Up:<a rel=up href="#Documentation">Documentation</a>
<br>

<h2>Change Logs</h2>

<p>Keep a change log to describe all the changes made to program source
files.  The purpose of this is so that people investigating bugs in the
future will know about the changes that might have introduced the bug. 
Often a new bug can be found by looking at what was recently changed. 
More importantly, change logs can help you eliminate conceptual
inconsistencies between different parts of a program, by giving you a
history of how the conflicting concepts arose and who they came from.

<ul>
<li><a href="#Change%20Log%20Concepts">Change Log Concepts</a>: 
<li><a href="#Style%20of%20Change%20Logs">Style of Change Logs</a>: 
<li><a href="#Simple%20Changes">Simple Changes</a>: 
<li><a href="#Conditional%20Changes">Conditional Changes</a>: 
</ul>

<p><hr>
Node:<a name="Change%20Log%20Concepts">Change Log Concepts</a>,
Next:<a rel=next href="#Style%20of%20Change%20Logs">Style of Change Logs</a>,
Up:<a rel=up href="#Change%20Logs">Change Logs</a>
<br>

<h3>Change Log Concepts</h3>

<p>You can think of the change log as a conceptual "undo list" which
explains how earlier versions were different from the current version. 
People can see the current version; they don't need the change log
to tell them what is in it.  What they want from a change log is a
clear explanation of how the earlier version differed.

<p>The change log file is normally called <code>ChangeLog</code> and covers an
entire directory.  Each directory can have its own change log, or a
directory can use the change log of its parent directory-it's up to
you.

<p>Another alternative is to record change log information with a version
control system such as RCS or CVS.  This can be converted automatically
to a <code>ChangeLog</code> file.

<p>There's no need to describe the full purpose of the changes or how they
work together.  If you think that a change calls for explanation, you're
probably right.  Please do explain it--but please put the explanation
in comments in the code, where people will see it whenever they see the
code.  For example, "New function" is enough for the change log when
you add a function, because there should be a comment before the
function definition to explain what it does.

<p>However, sometimes it is useful to write one line to describe the
overall purpose of a batch of changes.

<p>The easiest way to add an entry to <code>ChangeLog</code> is with the Emacs
command <kbd>M-x add-change-log-entry</kbd>.  An entry should have an
asterisk, the name of the changed file, and then in parentheses the name
of the changed functions, variables or whatever, followed by a colon. 
Then describe the changes you made to that function or variable.

<p><hr>
Node:<a name="Style%20of%20Change%20Logs">Style of Change Logs</a>,
Next:<a rel=next href="#Simple%20Changes">Simple Changes</a>,
Previous:<a rel=previous href="#Change%20Log%20Concepts">Change Log Concepts</a>,
Up:<a rel=up href="#Change%20Logs">Change Logs</a>
<br>

<h3>Style of Change Logs</h3>

<p>Here are some examples of change log entries:

<pre>* register.el (insert-register): Return nil.
(jump-to-register): Likewise.

* sort.el (sort-subr): Return nil.

* tex-mode.el (tex-bibtex-file, tex-file, tex-region):
Restart the tex shell if process is gone or stopped.
(tex-shell-running): New function.

* expr.c (store_one_arg): Round size up for move_block_to_reg.
(expand_call): Round up when emitting USE insns.
* stmt.c (assign_parms): Round size up for move_block_from_reg.
</pre>

<p>It's important to name the changed function or variable in full.  Don't
abbreviate function or variable names, and don't combine them. 
Subsequent maintainers will often search for a function name to find all
the change log entries that pertain to it; if you abbreviate the name,
they won't find it when they search.

<p>For example, some people are tempted to abbreviate groups of function
names by writing <code>* register.el ({insert,jump-to}-register)</code>;
this is not a good idea, since searching for <code>jump-to-register</code> or
<code>insert-register</code> would not find that entry.

<p>Separate unrelated change log entries with blank lines.  When two
entries represent parts of the same change, so that they work together,
then don't put blank lines between them.  Then you can omit the file
name and the asterisk when successive entries are in the same file.

<p><hr>
Node:<a name="Simple%20Changes">Simple Changes</a>,
Next:<a rel=next href="#Conditional%20Changes">Conditional Changes</a>,
Previous:<a rel=previous href="#Style%20of%20Change%20Logs">Style of Change Logs</a>,
Up:<a rel=up href="#Change%20Logs">Change Logs</a>
<br>

<h3>Simple Changes</h3>

<p>Certain simple kinds of changes don't need much detail in the change
log.

<p>When you change the calling sequence of a function in a simple fashion,
and you change all the callers of the function, there is no need to make
individual entries for all the callers that you changed.  Just write in
the entry for the function being called, "All callers changed."

<pre>* keyboard.c (Fcommand_execute): New arg SPECIAL.
All callers changed.
</pre>

<p>When you change just comments or doc strings, it is enough to write an
entry for the file, without mentioning the functions.  Just "Doc
fixes" is enough for the change log.

<p>There's no need to make change log entries for documentation files. 
This is because documentation is not susceptible to bugs that are hard
to fix.  Documentation does not consist of parts that must interact in a
precisely engineered fashion.  To correct an error, you need not know
the history of the erroneous passage; it is enough to compare what the
documentation says with the way the program actually works.

<p><hr>
Node:<a name="Conditional%20Changes">Conditional Changes</a>,
Previous:<a rel=previous href="#Simple%20Changes">Simple Changes</a>,
Up:<a rel=up href="#Change%20Logs">Change Logs</a>
<br>

<h3>Conditional Changes</h3>

<p>C programs often contain compile-time <code>#if</code> conditionals.  Many
changes are conditional; sometimes you add a new definition which is
entirely contained in a conditional.  It is very useful to indicate in
the change log the conditions for which the change applies.

<p>Our convention for indicating conditional changes is to use square
brackets around the name of the condition.

<p>Here is a simple example, describing a change which is conditional but
does not have a function or entity name associated with it:

<pre>* xterm.c [SOLARIS2]: Include string.h.
</pre>

<p>Here is an entry describing a new definition which is entirely
conditional.  This new definition for the macro <code>FRAME_WINDOW_P</code> is
used only when <code>HAVE_X_WINDOWS</code> is defined:

<pre>* frame.h [HAVE_X_WINDOWS] (FRAME_WINDOW_P): Macro defined.
</pre>

<p>Here is an entry for a change within the function <code>init_display</code>,
whose definition as a whole is unconditional, but the changes themselves
are contained in a <code>#ifdef HAVE_LIBNCURSES</code> conditional:

<pre>* dispnew.c (init_display) [HAVE_LIBNCURSES]: If X, call tgetent.
</pre>

<p>Here is an entry for a change that takes affect only when
a certain macro is <em>not</em> defined:

<pre>(gethostname) [!HAVE_SOCKETS]: Replace with winsock version.
</pre>

<p><hr>
Node:<a name="Man%20Pages">Man Pages</a>,
Next:<a rel=next href="#Reading%20other%20Manuals">Reading other Manuals</a>,
Previous:<a rel=previous href="#Change%20Logs">Change Logs</a>,
Up:<a rel=up href="#Documentation">Documentation</a>
<br>

<h2>Man Pages</h2>

<p>In the GNU project, man pages are secondary.  It is not necessary or
expected for every GNU program to have a man page, but some of them do. 
It's your choice whether to include a man page in your program.

<p>When you make this decision, consider that supporting a man page
requires continual effort each time the program is changed.  The time
you spend on the man page is time taken away from more useful work.

<p>For a simple program which changes little, updating the man page may be
a small job.  Then there is little reason not to include a man page, if
you have one.

<p>For a large program that changes a great deal, updating a man page may
be a substantial burden.  If a user offers to donate a man page, you may
find this gift costly to accept.  It may be better to refuse the man
page unless the same person agrees to take full responsibility for
maintaining it--so that you can wash your hands of it entirely.  If
this volunteer later ceases to do the job, then don't feel obliged to
pick it up yourself; it may be better to withdraw the man page from the
distribution until someone else agrees to update it.

<p>When a program changes only a little, you may feel that the
discrepancies are small enough that the man page remains useful without
updating.  If so, put a prominent note near the beginning of the man
page explaining that you don't maintain it and that the Texinfo manual
is more authoritative.  The note should say how to access the Texinfo
documentation.

<p><hr>
Node:<a name="Reading%20other%20Manuals">Reading other Manuals</a>,
Previous:<a rel=previous href="#Man%20Pages">Man Pages</a>,
Up:<a rel=up href="#Documentation">Documentation</a>
<br>

<h2>Reading other Manuals</h2>

<p>There may be non-free books or documentation files that describe the
program you are documenting.

<p>It is ok to use these documents for reference, just as the author of a
new algebra textbook can read other books on algebra.  A large portion
of any non-fiction book consists of facts, in this case facts about how
a certain program works, and these facts are necessarily the same for
everyone who writes about the subject.  But be careful not to copy your
outline structure, wording, tables or examples from preexisting non-free
documentation.  Copying from free documentation may be ok; please check
with the FSF about the individual case.

<p><hr>
Node:<a name="Managing%20Releases">Managing Releases</a>,
Previous:<a rel=previous href="#Documentation">Documentation</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>The Release Process</h1>

<p>Making a release is more than just bundling up your source files in a
tar file and putting it up for FTP.  You should set up your software so
that it can be configured to run on a variety of systems.  Your Makefile
should conform to the GNU standards described below, and your directory
layout should also conform to the standards discussed below.  Doing so
makes it easy to include your package into the larger framework of
all GNU software.

<ul>
<li><a href="#Configuration">Configuration</a>:                How Configuration Should Work
<li><a href="#Makefile%20Conventions">Makefile Conventions</a>: 	Makefile Conventions
<li><a href="#Releases">Releases</a>:                     Making Releases
</ul>

<p><hr>
Node:<a name="Configuration">Configuration</a>,
Next:<a rel=next href="#Makefile%20Conventions">Makefile Conventions</a>,
Up:<a rel=up href="#Managing%20Releases">Managing Releases</a>
<br>

<h2>How Configuration Should Work</h2>

<p>Each GNU distribution should come with a shell script named
<code>configure</code>.  This script is given arguments which describe the
kind of machine and system you want to compile the program for.

<p>The <code>configure</code> script must record the configuration options so
that they affect compilation.

<p>One way to do this is to make a link from a standard name such as
<code>config.h</code> to the proper configuration file for the chosen system. 
If you use this technique, the distribution should <em>not</em> contain a
file named <code>config.h</code>.  This is so that people won't be able to
build the program without configuring it first.

<p>Another thing that <code>configure</code> can do is to edit the Makefile.  If
you do this, the distribution should <em>not</em> contain a file named
<code>Makefile</code>.  Instead, it should include a file <code>Makefile.in</code> which
contains the input used for editing.  Once again, this is so that people
won't be able to build the program without configuring it first.

<p>If <code>configure</code> does write the <code>Makefile</code>, then <code>Makefile</code>
should have a target named <code>Makefile</code> which causes <code>configure</code>
to be rerun, setting up the same configuration that was set up last
time.  The files that <code>configure</code> reads should be listed as
dependencies of <code>Makefile</code>.

<p>All the files which are output from the <code>configure</code> script should
have comments at the beginning explaining that they were generated
automatically using <code>configure</code>.  This is so that users won't think
of trying to edit them by hand.

<p>The <code>configure</code> script should write a file named <code>config.status</code>
which describes which configuration options were specified when the
program was last configured.  This file should be a shell script which,
if run, will recreate the same configuration.

<p>The <code>configure</code> script should accept an option of the form
<code>--srcdir=<var>dirname</var></code> to specify the directory where sources are found
(if it is not the current directory).  This makes it possible to build
the program in a separate directory, so that the actual source directory
is not modified.

<p>If the user does not specify <code>--srcdir</code>, then <code>configure</code> should
check both <code>.</code> and <code>..</code> to see if it can find the sources.  If
it finds the sources in one of these places, it should use them from
there.  Otherwise, it should report that it cannot find the sources, and
should exit with nonzero status.

<p>Usually the easy way to support <code>--srcdir</code> is by editing a
definition of <code>VPATH</code> into the Makefile.  Some rules may need to
refer explicitly to the specified source directory.  To make this
possible, <code>configure</code> can add to the Makefile a variable named
<code>srcdir</code> whose value is precisely the specified directory.

<p>The <code>configure</code> script should also take an argument which specifies the
type of system to build the program for.  This argument should look like
this:

<pre><var>cpu</var>-<var>company</var>-<var>system</var>
</pre>

<p>For example, a Sun 3 might be <code>m68k-sun-sunos4.1</code>.

<p>The <code>configure</code> script needs to be able to decode all plausible
alternatives for how to describe a machine.  Thus, <code>sun3-sunos4.1</code>
would be a valid alias.  For many programs, <code>vax-dec-ultrix</code> would
be an alias for <code>vax-dec-bsd</code>, simply because the differences
between Ultrix and <small>BSD</small> are rarely noticeable, but a few programs
might need to distinguish them.

<p>There is a shell script called <code>config.sub</code> that you can use
as a subroutine to validate system types and canonicalize aliases.

<p>Other options are permitted to specify in more detail the software
or hardware present on the machine, and include or exclude optional
parts of the package:

<dl>
<dt><code>--enable-<var>feature</var>[=<var>parameter</var>]</code>
<dd>Configure the package to build and install an optional user-level
facility called <var>feature</var>.  This allows users to choose which
optional features to include.  Giving an optional <var>parameter</var> of
<code>no</code> should omit <var>feature</var>, if it is built by default.

<p>No <code>--enable</code> option should <strong>ever</strong> cause one feature to
replace another.  No <code>--enable</code> option should ever substitute one
useful behavior for another useful behavior.  The only proper use for
<code>--enable</code> is for questions of whether to build part of the program
or exclude it.

<br><dt><code>--with-<var>package</var></code>
<dd>The package <var>package</var> will be installed, so configure this package
to work with <var>package</var>.

<p>Possible values of <var>package</var> include
<code>gnu-as</code> (or <code>gas</code>), <code>gnu-ld</code>, <code>gnu-libc</code>,
<code>gdb</code>,
<code>x</code>,
and
<code>x-toolkit</code>.

<p>Do not use a <code>--with</code> option to specify the file name to use to
find certain files.  That is outside the scope of what <code>--with</code>
options are for.

<br><dt><code>--nfp</code>
<dd>The target machine has no floating point processor.

<br><dt><code>--gas</code>
<dd>The target machine assembler is GAS, the GNU assembler. 
This is obsolete; users should use <code>--with-gnu-as</code> instead.

<br><dt><code>--x</code>
<dd>The target machine has the X Window System installed. 
This is obsolete; users should use <code>--with-x</code> instead. 
</dl>

<p>All <code>configure</code> scripts should accept all of these "detail"
options, whether or not they make any difference to the particular
package at hand.  In particular, they should accept any option that
starts with <code>--with-</code> or <code>--enable-</code>.  This is so users will
be able to configure an entire GNU source tree at once with a single set
of options.

<p>You will note that the categories <code>--with-</code> and <code>--enable-</code>
are narrow: they <strong>do not</strong> provide a place for any sort of option
you might think of.  That is deliberate.  We want to limit the possible
configuration options in GNU software.  We do not want GNU programs to
have idiosyncratic configuration options.

<p>Packages that perform part of the compilation process may support cross-compilation. 
In such a case, the host and target machines for the program may be
different.  The <code>configure</code> script should normally treat the
specified type of system as both the host and the target, thus producing
a program which works for the same type of machine that it runs on.

<p>The way to build a cross-compiler, cross-assembler, or what have you, is
to specify the option <code>--host=<var>hosttype</var></code> when running
<code>configure</code>.  This specifies the host system without changing the
type of target system.  The syntax for <var>hosttype</var> is the same as
described above.

<p>Bootstrapping a cross-compiler requires compiling it on a machine other
than the host it will run on.  Compilation packages accept a
configuration option <code>--build=<var>hosttype</var></code> for specifying the
configuration on which you will compile them, in case that is different
from the host.

<p>Programs for which cross-operation is not meaningful need not accept the
<code>--host</code> option, because configuring an entire operating system for
cross-operation is not a meaningful thing.

<p>Some programs have ways of configuring themselves automatically.  If
your program is set up to do this, your <code>configure</code> script can simply
ignore most of its arguments.

<p><hr>
Node:<a name="Makefile%20Conventions">Makefile Conventions</a>,
Next:<a rel=next href="#Releases">Releases</a>,
Previous:<a rel=previous href="#Configuration">Configuration</a>,
Up:<a rel=up href="#Managing%20Releases">Managing Releases</a>
<br>

<h2>Makefile Conventions</h2>

<p>This
node
describes conventions for writing the Makefiles for GNU programs.

<ul>
<li><a href="#Makefile%20Basics">Makefile Basics</a>: 		General Conventions for Makefiles
<li><a href="#Utilities%20in%20Makefiles">Utilities in Makefiles</a>: 	Utilities in Makefiles
<li><a href="#Command%20Variables">Command Variables</a>: 		Variables for Specifying Commands
<li><a href="#Directory%20Variables">Directory Variables</a>: 		Variables for Installation Directories
<li><a href="#Standard%20Targets">Standard Targets</a>: 		Standard Targets for Users
<li><a href="#Install%20Command%20Categories">Install Command Categories</a>:   Three categories of commands in the `install'
                                  rule: normal, pre-install and post-install. 
</ul>

<p><hr>
Node:<a name="Makefile%20Basics">Makefile Basics</a>,
Next:<a rel=next href="#Utilities%20in%20Makefiles">Utilities in Makefiles</a>,
Up:<a rel=up href="#Makefile%20Conventions">Makefile Conventions</a>
<br>

<h3>General Conventions for Makefiles</h3>

<p>Every Makefile should contain this line:

<pre>SHELL = /bin/sh
</pre>

<p>to avoid trouble on systems where the <code>SHELL</code> variable might be
inherited from the environment.  (This is never a problem with GNU
<code>make</code>.)

<p>Different <code>make</code> programs have incompatible suffix lists and
implicit rules, and this sometimes creates confusion or misbehavior.  So
it is a good idea to set the suffix list explicitly using only the
suffixes you need in the particular Makefile, like this:

<pre>.SUFFIXES:
.SUFFIXES: .c .o
</pre>

<p>The first line clears out the suffix list, the second introduces all
suffixes which may be subject to implicit rules in this Makefile.

<p>Don't assume that <code>.</code> is in the path for command execution.  When
you need to run programs that are a part of your package during the
make, please make sure that it uses <code>./</code> if the program is built as
part of the make or <code>$(srcdir)/</code> if the file is an unchanging part
of the source code.  Without one of these prefixes, the current search
path is used.

<p>The distinction between <code>./</code> (the <dfn>build directory</dfn>) and
<code>$(srcdir)/</code> (the <dfn>source directory</dfn>) is important because
users can build in a separate directory using the <code>--srcdir</code> option
to <code>configure</code>.  A rule of the form:

<pre>foo.1 : foo.man sedscript
        sed -e sedscript foo.man &gt; foo.1
</pre>

<p>will fail when the build directory is not the source directory, because
<code>foo.man</code> and <code>sedscript</code> are in the the source directory.

<p>When using GNU <code>make</code>, relying on <code>VPATH</code> to find the source
file will work in the case where there is a single dependency file,
since the <code>make</code> automatic variable <code>$&lt;</code> will represent the
source file wherever it is.  (Many versions of <code>make</code> set <code>$&lt;</code>
only in implicit rules.)  A Makefile target like

<pre>foo.o : bar.c
        $(CC) -I. -I$(srcdir) $(CFLAGS) -c bar.c -o foo.o
</pre>

<p>should instead be written as

<pre>foo.o : bar.c
        $(CC) -I. -I$(srcdir) $(CFLAGS) -c $&lt; -o $@
</pre>

<p>in order to allow <code>VPATH</code> to work correctly.  When the target has
multiple dependencies, using an explicit <code>$(srcdir)</code> is the easiest
way to make the rule work well.  For example, the target above for
<code>foo.1</code> is best written as:

<pre>foo.1 : foo.man sedscript
        sed -e $(srcdir)/sedscript $(srcdir)/foo.man &gt; $@
</pre>

<p>GNU distributions usually contain some files which are not source
files--for example, Info files, and the output from Autoconf, Automake,
Bison or Flex.  Since these files normally appear in the source
directory, they should always appear in the source directory, not in the
build directory.  So Makefile rules to update them should put the
updated files in the source directory.

<p>However, if a file does not appear in the distribution, then the
Makefile should not put it in the source directory, because building a
program in ordinary circumstances should not modify the source directory
in any way.

<p>Try to make the build and installation targets, at least (and all their
subtargets) work correctly with a parallel <code>make</code>.

<p><hr>
Node:<a name="Utilities%20in%20Makefiles">Utilities in Makefiles</a>,
Next:<a rel=next href="#Command%20Variables">Command Variables</a>,
Previous:<a rel=previous href="#Makefile%20Basics">Makefile Basics</a>,
Up:<a rel=up href="#Makefile%20Conventions">Makefile Conventions</a>
<br>

<h3>Utilities in Makefiles</h3>

<p>Write the Makefile commands (and any shell scripts, such as
<code>configure</code>) to run in <code>sh</code>, not in <code>csh</code>.  Don't use any
special features of <code>ksh</code> or <code>bash</code>.

<p>The <code>configure</code> script and the Makefile rules for building and
installation should not use any utilities directly except these:

<pre>cat cmp cp diff echo egrep expr false grep install-info
ln ls mkdir mv pwd rm rmdir sed sleep sort tar test touch true
</pre>

<p>The compression program <code>gzip</code> can be used in the <code>dist</code> rule.

<p>Stick to the generally supported options for these programs.  For
example, don't use <code>mkdir -p</code>, convenient as it may be, because
most systems don't support it.

<p>It is a good idea to avoid creating symbolic links in makefiles, since a
few systems don't support them.

<p>The Makefile rules for building and installation can also use compilers
and related programs, but should do so via <code>make</code> variables so that the
user can substitute alternatives.  Here are some of the programs we
mean:

<pre>ar bison cc flex install ld ldconfig lex
make makeinfo ranlib texi2dvi yacc
</pre>

<p>Use the following <code>make</code> variables to run those programs:

<pre>$(AR) $(BISON) $(CC) $(FLEX) $(INSTALL) $(LD) $(LDCONFIG) $(LEX)
$(MAKE) $(MAKEINFO) $(RANLIB) $(TEXI2DVI) $(YACC)
</pre>

<p>When you use <code>ranlib</code> or <code>ldconfig</code>, you should make sure
nothing bad happens if the system does not have the program in question. 
Arrange to ignore an error from that command, and print a message before
the command to tell the user that failure of this command does not mean
a problem.  (The Autoconf <code>AC_PROG_RANLIB</code> macro can help with
this.)

<p>If you use symbolic links, you should implement a fallback for systems
that don't have symbolic links.

<p>Additional utilities that can be used via Make variables are:

<pre>chgrp chmod chown mknod
</pre>

<p>It is ok to use other utilities in Makefile portions (or scripts)
intended only for particular systems where you know those utilities
exist.

<p><hr>
Node:<a name="Command%20Variables">Command Variables</a>,
Next:<a rel=next href="#Directory%20Variables">Directory Variables</a>,
Previous:<a rel=previous href="#Utilities%20in%20Makefiles">Utilities in Makefiles</a>,
Up:<a rel=up href="#Makefile%20Conventions">Makefile Conventions</a>
<br>

<h3>Variables for Specifying Commands</h3>

<p>Makefiles should provide variables for overriding certain commands, options,
and so on.

<p>In particular, you should run most utility programs via variables. 
Thus, if you use Bison, have a variable named <code>BISON</code> whose default
value is set with <code>BISON = bison</code>, and refer to it with
<code>$(BISON)</code> whenever you need to use Bison.

<p>File management utilities such as <code>ln</code>, <code>rm</code>, <code>mv</code>, and
so on, need not be referred to through variables in this way, since users
don't need to replace them with other programs.

<p>Each program-name variable should come with an options variable that is
used to supply options to the program.  Append <code>FLAGS</code> to the
program-name variable name to get the options variable name--for
example, <code>BISONFLAGS</code>.  (The names <code>CFLAGS</code> for the C
compiler, <code>YFLAGS</code> for yacc, and <code>LFLAGS</code> for lex, are
exceptions to this rule, but we keep them because they are standard.) 
Use <code>CPPFLAGS</code> in any compilation command that runs the
preprocessor, and use <code>LDFLAGS</code> in any compilation command that
does linking as well as in any direct use of <code>ld</code>.

<p>If there are C compiler options that <em>must</em> be used for proper
compilation of certain files, do not include them in <code>CFLAGS</code>. 
Users expect to be able to specify <code>CFLAGS</code> freely themselves. 
Instead, arrange to pass the necessary options to the C compiler
independently of <code>CFLAGS</code>, by writing them explicitly in the
compilation commands or by defining an implicit rule, like this:

<pre>CFLAGS = -g
ALL_CFLAGS = -I. $(CFLAGS)
.c.o:
        $(CC) -c $(CPPFLAGS) $(ALL_CFLAGS) $&lt;
</pre>

<p>Do include the <code>-g</code> option in <code>CFLAGS</code>, because that is not
<em>required</em> for proper compilation.  You can consider it a default
that is only recommended.  If the package is set up so that it is
compiled with GCC by default, then you might as well include <code>-O</code>
in the default value of <code>CFLAGS</code> as well.

<p>Put <code>CFLAGS</code> last in the compilation command, after other variables
containing compiler options, so the user can use <code>CFLAGS</code> to
override the others.

<p><code>CFLAGS</code> should be used in every invocation of the C compiler,
both those which do compilation and those which do linking.

<p>Every Makefile should define the variable <code>INSTALL</code>, which is the
basic command for installing a file into the system.

<p>Every Makefile should also define the variables <code>INSTALL_PROGRAM</code>
and <code>INSTALL_DATA</code>.  (The default for each of these should be
<code>$(INSTALL)</code>.)  Then it should use those variables as the commands
for actual installation, for executables and nonexecutables
respectively.  Use these variables as follows:

<pre>$(INSTALL_PROGRAM) foo $(bindir)/foo
$(INSTALL_DATA) libfoo.a $(libdir)/libfoo.a
</pre>

<p>Optionally, you may prepend the value of <code>DESTDIR</code> to the target
filename.  Doing this allows the installer to create a snapshot of the
installation to be copied onto the real target filesystem later.  Do not
set the value of <code>DESTDIR</code> in your Makefile, and do not include it
in any installed files.  With support for <code>DESTDIR</code>, the above
examples become:

<pre>$(INSTALL_PROGRAM) foo $(DESTDIR)$(bindir)/foo
$(INSTALL_DATA) libfoo.a $(DESTDIR)$(libdir)/libfoo.a
</pre>

<p>Always use a file name, not a directory name, as the second argument of
the installation commands.  Use a separate command for each file to be
installed.

<p><hr>
Node:<a name="Directory%20Variables">Directory Variables</a>,
Next:<a rel=next href="#Standard%20Targets">Standard Targets</a>,
Previous:<a rel=previous href="#Command%20Variables">Command Variables</a>,
Up:<a rel=up href="#Makefile%20Conventions">Makefile Conventions</a>
<br>

<h3>Variables for Installation Directories</h3>

<p>Installation directories should always be named by variables, so it is
easy to install in a nonstandard place.  The standard names for these
variables are described below.  They are based on a standard filesystem
layout; variants of it are used in SVR4, 4.4BSD, Linux, Ultrix v4, and
other modern operating systems.

<p>These two variables set the root for the installation.  All the other
installation directories should be subdirectories of one of these two,
and nothing should be directly installed into these two directories.

<dl>
<dt><code>prefix</code>
<dd>A prefix used in constructing the default values of the variables listed
below.  The default value of <code>prefix</code> should be <code>/usr/local</code>. 
When building the complete GNU system, the prefix will be empty and
<code>/usr</code> will be a symbolic link to <code>/</code>. 
(If you are using Autoconf, write it as <code>@prefix@</code>.)

<p>Running <code>make install</code> with a different value of <code>prefix</code>
from the one used to build the program should <var>not</var> recompile
the program.

<br><dt><code>exec_prefix</code>
<dd>A prefix used in constructing the default values of some of the
variables listed below.  The default value of <code>exec_prefix</code> should
be <code>$(prefix)</code>. 
(If you are using Autoconf, write it as <code>@exec_prefix@</code>.)

<p>Generally, <code>$(exec_prefix)</code> is used for directories that contain
machine-specific files (such as executables and subroutine libraries),
while <code>$(prefix)</code> is used directly for other directories.

<p>Running <code>make install</code> with a different value of <code>exec_prefix</code>
from the one used to build the program should <var>not</var> recompile the
program. 
</dl>

<p>Executable programs are installed in one of the following directories.

<dl>
<dt><code>bindir</code>
<dd>The directory for installing executable programs that users can run. 
This should normally be <code>/usr/local/bin</code>, but write it as
<code>$(exec_prefix)/bin</code>. 
(If you are using Autoconf, write it as <code>@bindir@</code>.)

<br><dt><code>sbindir</code>
<dd>The directory for installing executable programs that can be run from
the shell, but are only generally useful to system administrators.  This
should normally be <code>/usr/local/sbin</code>, but write it as
<code>$(exec_prefix)/sbin</code>. 
(If you are using Autoconf, write it as <code>@sbindir@</code>.)

<br><dt><code>libexecdir</code>
<dd>The directory for installing executable programs to be run by other
programs rather than by users.  This directory should normally be
<code>/usr/local/libexec</code>, but write it as <code>$(exec_prefix)/libexec</code>. 
(If you are using Autoconf, write it as <code>@libexecdir@</code>.) 
</dl>

<p>Data files used by the program during its execution are divided into
categories in two ways.

<ul>
<li>Some files are normally modified by programs; others are never normally
modified (though users may edit some of these).

<li>Some files are architecture-independent and can be shared by all
machines at a site; some are architecture-dependent and can be shared
only by machines of the same kind and operating system; others may never
be shared between two machines. 
</ul>

<p>This makes for six different possibilities.  However, we want to
discourage the use of architecture-dependent files, aside from object
files and libraries.  It is much cleaner to make other data files
architecture-independent, and it is generally not hard.

<p>Therefore, here are the variables Makefiles should use to specify
directories:

<dl>
<dt><code>datadir</code>
<dd>The directory for installing read-only architecture independent data
files.  This should normally be <code>/usr/local/share</code>, but write it as
<code>$(prefix)/share</code>. 
(If you are using Autoconf, write it as <code>@datadir@</code>.) 
As a special exception, see <code>$(infodir)</code>
and <code>$(includedir)</code> below.

<br><dt><code>sysconfdir</code>
<dd>The directory for installing read-only data files that pertain to a
single machine-that is to say, files for configuring a host.  Mailer
and network configuration files, <code>/etc/passwd</code>, and so forth belong
here.  All the files in this directory should be ordinary ASCII text
files.  This directory should normally be <code>/usr/local/etc</code>, but
write it as <code>$(prefix)/etc</code>. 
(If you are using Autoconf, write it as <code>@sysconfdir@</code>.)

<p>Do not install executables here in this directory (they probably belong
in <code>$(libexecdir)</code> or <code>$(sbindir)</code>).  Also do not install
files that are modified in the normal course of their use (programs
whose purpose is to change the configuration of the system excluded). 
Those probably belong in <code>$(localstatedir)</code>.

<br><dt><code>sharedstatedir</code>
<dd>The directory for installing architecture-independent data files which
the programs modify while they run.  This should normally be
<code>/usr/local/com</code>, but write it as <code>$(prefix)/com</code>. 
(If you are using Autoconf, write it as <code>@sharedstatedir@</code>.)

<br><dt><code>localstatedir</code>
<dd>The directory for installing data files which the programs modify while
they run, and that pertain to one specific machine.  Users should never
need to modify files in this directory to configure the package's
operation; put such configuration information in separate files that go
in <code>$(datadir)</code> or <code>$(sysconfdir)</code>.  <code>$(localstatedir)</code>
should normally be <code>/usr/local/var</code>, but write it as
<code>$(prefix)/var</code>. 
(If you are using Autoconf, write it as <code>@localstatedir@</code>.)

<br><dt><code>libdir</code>
<dd>The directory for object files and libraries of object code.  Do not
install executables here, they probably ought to go in <code>$(libexecdir)</code>
instead.  The value of <code>libdir</code> should normally be
<code>/usr/local/lib</code>, but write it as <code>$(exec_prefix)/lib</code>. 
(If you are using Autoconf, write it as <code>@libdir@</code>.)

<br><dt><code>infodir</code>
<dd>The directory for installing the Info files for this package.  By
default, it should be <code>/usr/local/info</code>, but it should be written
as <code>$(prefix)/info</code>. 
(If you are using Autoconf, write it as <code>@infodir@</code>.)

<br><dt><code>lispdir</code>
<dd>The directory for installing any Emacs Lisp files in this package.  By
default, it should be <code>/usr/local/share/emacs/site-lisp</code>, but it
should be written as <code>$(prefix)/share/emacs/site-lisp</code>.

<p>If you are using Autoconf, write the default as <code>@lispdir@</code>. 
In order to make <code>@lispdir@</code> work, you need the following lines
in your <code>configure.in</code> file:

<pre>lispdir='${datadir}/emacs/site-lisp'
AC_SUBST(lispdir)
</pre>

<br><dt><code>includedir</code>
<dd>The directory for installing header files to be included by user
programs with the C <code>#include</code> preprocessor directive.  This
should normally be <code>/usr/local/include</code>, but write it as
<code>$(prefix)/include</code>. 
(If you are using Autoconf, write it as <code>@includedir@</code>.)

<p>Most compilers other than GCC do not look for header files in directory
<code>/usr/local/include</code>.  So installing the header files this way is
only useful with GCC.  Sometimes this is not a problem because some
libraries are only really intended to work with GCC.  But some libraries
are intended to work with other compilers.  They should install their
header files in two places, one specified by <code>includedir</code> and one
specified by <code>oldincludedir</code>.

<br><dt><code>oldincludedir</code>
<dd>The directory for installing <code>#include</code> header files for use with
compilers other than GCC.  This should normally be <code>/usr/include</code>. 
(If you are using Autoconf, you can write it as <code>@oldincludedir@</code>.)

<p>The Makefile commands should check whether the value of
<code>oldincludedir</code> is empty.  If it is, they should not try to use
it; they should cancel the second installation of the header files.

<p>A package should not replace an existing header in this directory unless
the header came from the same package.  Thus, if your Foo package
provides a header file <code>foo.h</code>, then it should install the header
file in the <code>oldincludedir</code> directory if either (1) there is no
<code>foo.h</code> there or (2) the <code>foo.h</code> that exists came from the Foo
package.

<p>To tell whether <code>foo.h</code> came from the Foo package, put a magic
string in the file--part of a comment--and <code>grep</code> for that string. 
</dl>

<p>Unix-style man pages are installed in one of the following:

<dl>
<dt><code>mandir</code>
<dd>The top-level directory for installing the man pages (if any) for this
package.  It will normally be <code>/usr/local/man</code>, but you should
write it as <code>$(prefix)/man</code>. 
(If you are using Autoconf, write it as <code>@mandir@</code>.)

<br><dt><code>man1dir</code>
<dd>The directory for installing section 1 man pages.  Write it as
<code>$(mandir)/man1</code>. 
<br><dt><code>man2dir</code>
<dd>The directory for installing section 2 man pages.  Write it as
<code>$(mandir)/man2</code>
<br><dt><code><small>...</small></code>
<dd>
<strong>Don't make the primary documentation for any GNU software be a
man page.  Write a manual in Texinfo instead.  Man pages are just for
the sake of people running GNU software on Unix, which is a secondary
application only.</strong>

<br><dt><code>manext</code>
<dd>The file name extension for the installed man page.  This should contain
a period followed by the appropriate digit; it should normally be <code>.1</code>.

<br><dt><code>man1ext</code>
<dd>The file name extension for installed section 1 man pages. 
<br><dt><code>man2ext</code>
<dd>The file name extension for installed section 2 man pages. 
<br><dt><code><small>...</small></code>
<dd>Use these names instead of <code>manext</code> if the package needs to install man
pages in more than one section of the manual. 
</dl>

<p>And finally, you should set the following variable:

<dl>
<dt><code>srcdir</code>
<dd>The directory for the sources being compiled.  The value of this
variable is normally inserted by the <code>configure</code> shell script. 
(If you are using Autconf, use <code>srcdir = @srcdir@</code>.) 
</dl>

<p>For example:

<pre># Common prefix for installation directories.
# NOTE: This directory must exist when you start the install.
prefix = /usr/local
exec_prefix = $(prefix)
# Where to put the executable for the command `gcc'.
bindir = $(exec_prefix)/bin
# Where to put the directories used by the compiler.
libexecdir = $(exec_prefix)/libexec
# Where to put the Info files.
infodir = $(prefix)/info
</pre>

<p>If your program installs a large number of files into one of the
standard user-specified directories, it might be useful to group them
into a subdirectory particular to that program.  If you do this, you
should write the <code>install</code> rule to create these subdirectories.

<p>Do not expect the user to include the subdirectory name in the value of
any of the variables listed above.  The idea of having a uniform set of
variable names for installation directories is to enable the user to
specify the exact same values for several different GNU packages.  In
order for this to be useful, all the packages must be designed so that
they will work sensibly when the user does so.

<p><hr>
Node:<a name="Standard%20Targets">Standard Targets</a>,
Next:<a rel=next href="#Install%20Command%20Categories">Install Command Categories</a>,
Previous:<a rel=previous href="#Directory%20Variables">Directory Variables</a>,
Up:<a rel=up href="#Makefile%20Conventions">Makefile Conventions</a>
<br>

<h3>Standard Targets for Users</h3>

<p>All GNU programs should have the following targets in their Makefiles:

<dl>
<dt><code>all</code>
<dd>Compile the entire program.  This should be the default target.  This
target need not rebuild any documentation files; Info files should
normally be included in the distribution, and DVI files should be made
only when explicitly asked for.

<p>By default, the Make rules should compile and link with <code>-g</code>, so
that executable programs have debugging symbols.  Users who don't mind
being helpless can strip the executables later if they wish.

<br><dt><code>install</code>
<dd>Compile the program and copy the executables, libraries, and so on to
the file names where they should reside for actual use.  If there is a
simple test to verify that a program is properly installed, this target
should run that test.

<p>Do not strip executables when installing them.  Devil-may-care users can
use the <code>install-strip</code> target to do that.

<p>If possible, write the <code>install</code> target rule so that it does not
modify anything in the directory where the program was built, provided
<code>make all</code> has just been done.  This is convenient for building the
program under one user name and installing it under another.

<p>The commands should create all the directories in which files are to be
installed, if they don't already exist.  This includes the directories
specified as the values of the variables <code>prefix</code> and
<code>exec_prefix</code>, as well as all subdirectories that are needed. 
One way to do this is by means of an <code>installdirs</code> target
as described below.

<p>Use <code>-</code> before any command for installing a man page, so that
<code>make</code> will ignore any errors.  This is in case there are systems
that don't have the Unix man page documentation system installed.

<p>The way to install Info files is to copy them into <code>$(infodir)</code>
with <code>$(INSTALL_DATA)</code> (see <a href="#Command%20Variables">Command Variables</a>), and then run
the <code>install-info</code> program if it is present.  <code>install-info</code>
is a program that edits the Info <code>dir</code> file to add or update the
menu entry for the given Info file; it is part of the Texinfo package. 
Here is a sample rule to install an Info file:

<pre>$(DESTDIR)$(infodir)/foo.info: foo.info
        $(POST_INSTALL)
# There may be a newer info file in . than in srcdir.
        -if test -f foo.info; then d=.; \
         else d=$(srcdir); fi; \
        $(INSTALL_DATA) $$d/foo.info $(DESTDIR)$@; \
# Run install-info only if it exists.
# Use `if' instead of just prepending `-' to the
# line so we notice real errors from install-info.
# We use `$(SHELL) -c' because some shells do not
# fail gracefully when there is an unknown command.
        if $(SHELL) -c 'install-info --version' \
           &gt;/dev/null 2&gt;&amp;1; then \
          install-info --dir-file=$(DESTDIR)$(infodir)/dir \
                       $(DESTDIR)$(infodir)/foo.info; \
        else true; fi
</pre>

<p>When writing the <code>install</code> target, you must classify all the
commands into three categories: normal ones, <dfn>pre-installation</dfn>
commands and <dfn>post-installation</dfn> commands.  See <a href="#Install%20Command%20Categories">Install Command Categories</a>.

<br><dt><code>uninstall</code>
<dd>Delete all the installed files--the copies that the <code>install</code>
target creates.

<p>This rule should not modify the directories where compilation is done,
only the directories where files are installed.

<p>The uninstallation commands are divided into three categories, just like
the installation commands.  See <a href="#Install%20Command%20Categories">Install Command Categories</a>.

<br><dt><code>install-strip</code>
<dd>Like <code>install</code>, but strip the executable files while installing
them.  In many cases, the definition of this target can be very simple:

<pre>install-strip:
        $(MAKE) INSTALL_PROGRAM='$(INSTALL_PROGRAM) -s' \
                install
</pre>

<p>Normally we do not recommend stripping an executable unless you are sure
the program has no bugs.  However, it can be reasonable to install a
stripped executable for actual execution while saving the unstripped
executable elsewhere in case there is a bug.

<br><dt><code>clean</code>
<dd>
Delete all files from the current directory that are normally created by
building the program.  Don't delete the files that record the
configuration.  Also preserve files that could be made by building, but
normally aren't because the distribution comes with them.

<p>Delete <code>.dvi</code> files here if they are not part of the distribution.

<br><dt><code>distclean</code>
<dd>Delete all files from the current directory that are created by
configuring or building the program.  If you have unpacked the source
and built the program without creating any other files, <code>make
distclean</code> should leave only the files that were in the distribution.

<br><dt><code>mostlyclean</code>
<dd>Like <code>clean</code>, but may refrain from deleting a few files that people
normally don't want to recompile.  For example, the <code>mostlyclean</code>
target for GCC does not delete <code>libgcc.a</code>, because recompiling it
is rarely necessary and takes a lot of time.

<br><dt><code>maintainer-clean</code>
<dd>Delete almost everything from the current directory that can be
reconstructed with this Makefile.  This typically includes everything
deleted by <code>distclean</code>, plus more: C source files produced by
Bison, tags tables, Info files, and so on.

<p>The reason we say "almost everything" is that running the command
<code>make maintainer-clean</code> should not delete <code>configure</code> even if
<code>configure</code> can be remade using a rule in the Makefile.  More generally,
<code>make maintainer-clean</code> should not delete anything that needs to
exist in order to run <code>configure</code> and then begin to build the
program.  This is the only exception; <code>maintainer-clean</code> should
delete everything else that can be rebuilt.

<p>The <code>maintainer-clean</code> target is intended to be used by a maintainer of
the package, not by ordinary users.  You may need special tools to
reconstruct some of the files that <code>make maintainer-clean</code> deletes. 
Since these files are normally included in the distribution, we don't
take care to make them easy to reconstruct.  If you find you need to
unpack the full distribution again, don't blame us.

<p>To help make users aware of this, the commands for the special
<code>maintainer-clean</code> target should start with these two:

<pre>@echo 'This command is intended for maintainers to use; it'
@echo 'deletes files that may need special tools to rebuild.'
</pre>

<br><dt><code>TAGS</code>
<dd>Update a tags table for this program.

<br><dt><code>info</code>
<dd>Generate any Info files needed.  The best way to write the rules is as
follows:

<pre>info: foo.info

foo.info: foo.texi chap1.texi chap2.texi
        $(MAKEINFO) $(srcdir)/foo.texi
</pre>

<p>You must define the variable <code>MAKEINFO</code> in the Makefile.  It should
run the <code>makeinfo</code> program, which is part of the Texinfo
distribution.

<p>Normally a GNU distribution comes with Info files, and that means the
Info files are present in the source directory.  Therefore, the Make
rule for an info file should update it in the source directory.  When
users build the package, ordinarily Make will not update the Info files
because they will already be up to date.

<br><dt><code>dvi</code>
<dd>Generate DVI files for all Texinfo documentation. 
For example:

<pre>dvi: foo.dvi

foo.dvi: foo.texi chap1.texi chap2.texi
        $(TEXI2DVI) $(srcdir)/foo.texi
</pre>

<p>You must define the variable <code>TEXI2DVI</code> in the Makefile.  It should
run the program <code>texi2dvi</code>, which is part of the Texinfo
distribution.<a rel=footnote href="#fn-1"><sup>1</sup></a>  Alternatively,
write just the dependencies, and allow GNU <code>make</code> to provide the command.

<br><dt><code>dist</code>
<dd>Create a distribution tar file for this program.  The tar file should be
set up so that the file names in the tar file start with a subdirectory
name which is the name of the package it is a distribution for.  This
name can include the version number.

<p>For example, the distribution tar file of GCC version 1.40 unpacks into
a subdirectory named <code>gcc-1.40</code>.

<p>The easiest way to do this is to create a subdirectory appropriately
named, use <code>ln</code> or <code>cp</code> to install the proper files in it, and
then <code>tar</code> that subdirectory.

<p>Compress the tar file file with <code>gzip</code>.  For example, the actual
distribution file for GCC version 1.40 is called <code>gcc-1.40.tar.gz</code>.

<p>The <code>dist</code> target should explicitly depend on all non-source files
that are in the distribution, to make sure they are up to date in the
distribution. 
See <a href="#Releases">Making Releases</a>.

<br><dt><code>check</code>
<dd>Perform self-tests (if any).  The user must build the program before
running the tests, but need not install the program; you should write
the self-tests so that they work when the program is built but not
installed. 
</dl>

<p>The following targets are suggested as conventional names, for programs
in which they are useful.

<dl>
<dt><code>installcheck</code>
<dd>Perform installation tests (if any).  The user must build and install
the program before running the tests.  You should not assume that
<code>$(bindir)</code> is in the search path.

<br><dt><code>installdirs</code>
<dd>It's useful to add a target named <code>installdirs</code> to create the
directories where files are installed, and their parent directories. 
There is a script called <code>mkinstalldirs</code> which is convenient for
this; you can find it in the Texinfo package. 
You can use a rule like this:

<pre># Make sure all installation directories (e.g. $(bindir))
# actually exist by making them if necessary.
installdirs: mkinstalldirs
        $(srcdir)/mkinstalldirs $(bindir) $(datadir) \
                                $(libdir) $(infodir) \
                                $(mandir)
</pre>

<p>This rule should not modify the directories where compilation is done. 
It should do nothing but create installation directories. 
</dl>

<p><hr>
Node:<a name="Install%20Command%20Categories">Install Command Categories</a>,
Previous:<a rel=previous href="#Standard%20Targets">Standard Targets</a>,
Up:<a rel=up href="#Makefile%20Conventions">Makefile Conventions</a>
<br>

<h3>Install Command Categories</h3>

<p>When writing the <code>install</code> target, you must classify all the
commands into three categories: normal ones, <dfn>pre-installation</dfn>
commands and <dfn>post-installation</dfn> commands.

<p>Normal commands move files into their proper places, and set their
modes.  They may not alter any files except the ones that come entirely
from the package they belong to.

<p>Pre-installation and post-installation commands may alter other files;
in particular, they can edit global configuration files or data bases.

<p>Pre-installation commands are typically executed before the normal
commands, and post-installation commands are typically run after the
normal commands.

<p>The most common use for a post-installation command is to run
<code>install-info</code>.  This cannot be done with a normal command, since
it alters a file (the Info directory) which does not come entirely and
solely from the package being installed.  It is a post-installation
command because it needs to be done after the normal command which
installs the package's Info files.

<p>Most programs don't need any pre-installation commands, but we have the
feature just in case it is needed.

<p>To classify the commands in the <code>install</code> rule into these three
categories, insert <dfn>category lines</dfn> among them.  A category line
specifies the category for the commands that follow.

<p>A category line consists of a tab and a reference to a special Make
variable, plus an optional comment at the end.  There are three
variables you can use, one for each category; the variable name
specifies the category.  Category lines are no-ops in ordinary execution
because these three Make variables are normally undefined (and you
<em>should not</em> define them in the makefile).

<p>Here are the three possible category lines, each with a comment that
explains what it means:

<pre>        $(PRE_INSTALL)     # Pre-install commands follow.
        $(POST_INSTALL)    # Post-install commands follow.
        $(NORMAL_INSTALL)  # Normal commands follow.
</pre>

<p>If you don't use a category line at the beginning of the <code>install</code>
rule, all the commands are classified as normal until the first category
line.  If you don't use any category lines, all the commands are
classified as normal.

<p>These are the category lines for <code>uninstall</code>:

<pre>        $(PRE_UNINSTALL)     # Pre-uninstall commands follow.
        $(POST_UNINSTALL)    # Post-uninstall commands follow.
        $(NORMAL_UNINSTALL)  # Normal commands follow.
</pre>

<p>Typically, a pre-uninstall command would be used for deleting entries
from the Info directory.

<p>If the <code>install</code> or <code>uninstall</code> target has any dependencies
which act as subroutines of installation, then you should start
<em>each</em> dependency's commands with a category line, and start the
main target's commands with a category line also.  This way, you can
ensure that each command is placed in the right category regardless of
which of the dependencies actually run.

<p>Pre-installation and post-installation commands should not run any
programs except for these:

<pre>[ basename bash cat chgrp chmod chown cmp cp dd diff echo
egrep expand expr false fgrep find getopt grep gunzip gzip
hostname install install-info kill ldconfig ln ls md5sum
mkdir mkfifo mknod mv printenv pwd rm rmdir sed sort tee
test touch true uname xargs yes
</pre>

<p>The reason for distinguishing the commands in this way is for the sake
of making binary packages.  Typically a binary package contains all the
executables and other files that need to be installed, and has its own
method of installing them--so it does not need to run the normal
installation commands.  But installing the binary package does need to
execute the pre-installation and post-installation commands.

<p>Programs to build binary packages work by extracting the
pre-installation and post-installation commands.  Here is one way of
extracting the pre-installation commands:

<pre>make -n install -o all \
      PRE_INSTALL=pre-install \
      POST_INSTALL=post-install \
      NORMAL_INSTALL=normal-install \
  | gawk -f pre-install.awk
</pre>

<p>where the file <code>pre-install.awk</code> could contain this:

<pre>$0 ~ /^\t[ \t]*(normal_install|post_install)[ \t]*$/ {on = 0}
on {print $0}
$0 ~ /^\t[ \t]*pre_install[ \t]*$/ {on = 1}
</pre>

<p>The resulting file of pre-installation commands is executed as a shell
script as part of installing the binary package.

<p><hr>
Node:<a name="Releases">Releases</a>,
Previous:<a rel=previous href="#Makefile%20Conventions">Makefile Conventions</a>,
Up:<a rel=up href="#Managing%20Releases">Managing Releases</a>
<br>

<h2>Making Releases</h2>

<p>Package the distribution of <code>Foo version 69.96</code> up in a gzipped tar
file with the name <code>foo-69.96.tar.gz</code>.  It should unpack into a
subdirectory named <code>foo-69.96</code>.

<p>Building and installing the program should never modify any of the files
contained in the distribution.  This means that all the files that form
part of the program in any way must be classified into <dfn>source
files</dfn> and <dfn>non-source files</dfn>.  Source files are written by humans
and never changed automatically; non-source files are produced from
source files by programs under the control of the Makefile.

<p>Naturally, all the source files must be in the distribution.  It is okay
to include non-source files in the distribution, provided they are
up-to-date and machine-independent, so that building the distribution
normally will never modify them.  We commonly include non-source files
produced by Bison, <code>lex</code>, TeX, and <code>makeinfo</code>; this helps avoid
unnecessary dependencies between our distributions, so that users can
install whichever packages they want to install.

<p>Non-source files that might actually be modified by building and
installing the program should <strong>never</strong> be included in the
distribution.  So if you do distribute non-source files, always make
sure they are up to date when you make a new distribution.

<p>Make sure that the directory into which the distribution unpacks (as
well as any subdirectories) are all world-writable (octal mode 777). 
This is so that old versions of <code>tar</code> which preserve the
ownership and permissions of the files from the tar archive will be
able to extract all the files even if the user is unprivileged.

<p>Make sure that all the files in the distribution are world-readable.

<p>Make sure that no file name in the distribution is more than 14
characters long.  Likewise, no file created by building the program
should have a name longer than 14 characters.  The reason for this is
that some systems adhere to a foolish interpretation of the POSIX
standard, and refuse to open a longer name, rather than truncating as
they did in the past.

<p>Don't include any symbolic links in the distribution itself.  If the tar
file contains symbolic links, then people cannot even unpack it on
systems that don't support symbolic links.  Also, don't use multiple
names for one file in different directories, because certain file
systems cannot handle this and that prevents unpacking the
distribution.

<p>Try to make sure that all the file names will be unique on MS-DOS.  A
name on MS-DOS consists of up to 8 characters, optionally followed by a
period and up to three characters.  MS-DOS will truncate extra
characters both before and after the period.  Thus,
<code>foobarhacker.c</code> and <code>foobarhacker.o</code> are not ambiguous; they
are truncated to <code>foobarha.c</code> and <code>foobarha.o</code>, which are
distinct.

<p>Include in your distribution a copy of the <code>texinfo.tex</code> you used
to test print any <code>*.texinfo</code> or <code>*.texi</code> files.

<p>Likewise, if your program uses small GNU software packages like regex,
getopt, obstack, or termcap, include them in the distribution file. 
Leaving them out would make the distribution file a little smaller at
the expense of possible inconvenience to a user who doesn't know what
other files to get.


<h1>Table of Contents</h1>
<ul>
<li><a href="#Top">Version</a>
<li><a href="#Preface">About the GNU Coding Standards</a>
<li><a href="#Intellectual%20Property">Keeping Free Software Free</a>
<ul>
<li><a href="#Reading%20Non-Free%20Code">Referring to Proprietary Programs</a>
<li><a href="#Contributions">Accepting Contributions</a>
</ul>
<li><a href="#Design%20Advice">General Program Design</a>
<ul>
<li><a href="#Compatibility">Compatibility with Other Implementations</a>
<li><a href="#Using%20Extensions">Using Non-standard Features</a>
<li><a href="#ANSI%20C"><small>ANSI</small> C and pre-<small>ANSI</small> C</a>
<li><a href="#Source%20Language">Using Languages Other Than C</a>
</ul>
<li><a href="#Program%20Behavior">Program Behavior for All Programs</a>
<ul>
<li><a href="#Semantics">Writing Robust Programs</a>
<li><a href="#Libraries">Library Behavior</a>
<li><a href="#Errors">Formatting Error Messages</a>
<li><a href="#User%20Interfaces">Standards for Command Line Interfaces</a>
<li><a href="#Option%20Table">Table of Long Options</a>
<li><a href="#Memory%20Usage">Memory Usage</a>
</ul>
<li><a href="#Writing%20C">Making The Best Use of C</a>
<ul>
<li><a href="#Formatting">Formatting Your Source Code</a>
<li><a href="#Comments">Commenting Your Work</a>
<li><a href="#Syntactic%20Conventions">Clean Use of C Constructs</a>
<li><a href="#Names">Naming Variables and Functions</a>
<li><a href="#System%20Portability">Portability between System Types</a>
<li><a href="#CPU%20Portability">Portability between <small>CPU</small>s</a>
<li><a href="#System%20Functions">Calling System Functions</a>
<li><a href="#Internationalization">Internationalization</a>
<li><a href="#Mmap">Mmap</a>
</ul>
<li><a href="#Documentation">Documenting Programs</a>
<ul>
<li><a href="#GNU%20Manuals">GNU Manuals</a>
<li><a href="#Manual%20Structure%20Details">Manual Structure Details</a>
<li><a href="#NEWS%20File">The NEWS File</a>
<li><a href="#Change%20Logs">Change Logs</a>
<ul>
<li><a href="#Change%20Log%20Concepts">Change Log Concepts</a>
<li><a href="#Style%20of%20Change%20Logs">Style of Change Logs</a>
<li><a href="#Simple%20Changes">Simple Changes</a>
<li><a href="#Conditional%20Changes">Conditional Changes</a>
</ul>
<li><a href="#Man%20Pages">Man Pages</a>
<li><a href="#Reading%20other%20Manuals">Reading other Manuals</a>
</ul>
<li><a href="#Managing%20Releases">The Release Process</a>
<ul>
<li><a href="#Configuration">How Configuration Should Work</a>
<li><a href="#Makefile%20Conventions">Makefile Conventions</a>
<ul>
<li><a href="#Makefile%20Basics">General Conventions for Makefiles</a>
<li><a href="#Utilities%20in%20Makefiles">Utilities in Makefiles</a>
<li><a href="#Command%20Variables">Variables for Specifying Commands</a>
<li><a href="#Directory%20Variables">Variables for Installation Directories</a>
<li><a href="#Standard%20Targets">Standard Targets for Users</a>
<li><a href="#Install%20Command%20Categories">Install Command Categories</a>
</ul>
<li><a href="#Releases">Making Releases</a>
</ul>
</ul>

<hr><h4>Footnotes</h4>
<ol type="1">
<li><a name="fn-1"></a>
<p><code>texi2dvi</code> uses TeX to do the real work
of formatting. TeX is not distributed with Texinfo.</p>

</ol><hr>

</body></html>

